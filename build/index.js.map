{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/index.js","src/filters.js","src/app.html","node_modules/riot/riot.js","src/views/user-view.html","src/views/item-view.html","src/views/news-view.html","src/store.js","src/components/item.html","src/components/comment.html","node_modules/events/events.js"],"names":["require","mount","parser","document","createElement","window","filters","fromNow","time","between","Date","now","Number","domain","url","href","hostname","riot","module","exports","tag2","opts","self","this","currentView","loadView","viewName","id","unmount","data","bind","studyRoute","view","route","on","start","undefined","mkitem","expr","key","val","item","pos","unmountRedundant","items","tags","t","i","length","j","splice","moveNestedTags","child","Object","keys","forEach","tagName","tag","isArray","each","moveChildTag","addVirtual","src","target","sib","el","_root","_virts","nextSibling","insertBefore","appendChild","push","moveVirtual","len","_each","dom","parent","remAttr","hasKeys","mustReorder","getAttr","T_STRING","getTagName","impl","__tagImpl","tmpl","outerHTML","useRoot","SPECIAL_TAGS_REGEX","test","root","parentNode","ref","createTextNode","getTag","isOption","oldItems","isVirtual","loopKeys","one","removeChild","stub","frag","createDocumentFragment","map","itemsLength","_mustReorder","oldPos","indexOf","Tag","isLoop","hasImpl","cloneNode","innerHTML","firstChild","update","childNodes","_item","defineProperty","slice","parseNamedElements","childTags","forceParsingNamed","walk","nodeType","initChildTag","setNamed","parseExpressions","expressions","addExpr","extra","hasExpr","extend","attr","type","nodeValue","attributes","name","bool","split","value","conf","updateOpts","ctx","toCamel","normalizeData","T_UNDEF","isWritable","inheritFromParent","k","mustSync","contains","RESERVED_WORDS_BLACKLIST","propsInSyncWithParent","toggle","isMount","evt","observable","inherit","cleanUpData","fn","toLowerCase","implAttr","_tag","isMounted","__uid","mkdom","attrs","isObject","trigger","rAF","arguments","mix","instance","mixin","isFunction","prototype","getOwnPropertyNames","init","globalMixin","GLOBAL_MIXIN","call","walkAttributes","v","setAttr","isInStub","keepRootTag","ptag","p","tagIndex","__virtualDom","getImmediateCustomParentTag","_riot_id","off","setEventHandler","handler","e","_parent","event","currentTarget","srcElement","which","charCode","keyCode","preventDefault","returnValue","preventUpdate","insertTo","node","before","attrName","IE_VERSION","add","remove","inStub","style","display","nodeName","T_OBJECT","startsWith","RIOT_PREFIX","RIOT_TAG","els","T_FUNCTION","removeAttribute","string","replace","_","c","toUpperCase","getAttribute","setAttribute","addChildTag","cachedTag","newPos","options","enumerable","writable","configurable","namedTag","obj","args","arr","a","Array","props","getOwnPropertyDescriptor","o","html","m","re","exec","mkEl","$$","selector","querySelectorAll","$","querySelector","Child","getNamedKey","isArr","str","mountTo","_innerHTML","version","settings","documentMode","callbacks","onEachEvent","defineProperties","events","typed","cb","apply","fns","arglen","busy","concat","DEFAULT_PARSER","path","DEFAULT_SECOND_PARSER","filter","RegExp","REPLACE","match","debounce","delay","clearTimeout","setTimeout","autoExec","debouncedEmit","emit","win","ADD_EVENT_LISTENER","POPSTATE","HASHCHANGE","doc","clickEvent","click","Router","central","s","normalize","isString","getPathFromRoot","loc","RE_ORIGIN","getPathFromBase","base","force","isRoot","emitStackLevel","MAX_EMIT_STACK_LEVEL","emitStack","current","TRIGGER","shift","metaKey","ctrlKey","shiftKey","defaultPrevented","HAS_ATTRIBUTE","go","title","shouldReplace","hist","replaceState","pushState","routeFound","secondParser","EVENT_LISTENER","REMOVE_EVENT_LISTENER","history","location","prot","ontouchstart","started","first","second","third","r","some","action","mainRouter","create","newSubRouter","stop","arg","fn2","query","q","readyState","brackets","UNDEF","_loopback","_rewrite","bp","_cache","source","global","REGLOB","_create","pair","DEFAULT","_pairs","Error","S_QBLOCKS","_brackets","reOrIdx","_regex","_reset","cachedBrackets","_setSettings","b","set","get","_settings","R_MLCOMMS","R_STRINGS","FINDBRACES","(","[","{","_bp","unescapeStr","isexpr","parts","skipBraces","ch","ix","recch","lastIndex","index","trim","hasRaw","array","_tmpl","_logErr","err","errorHandler","riotData","_getTmpl","Function","qstr","list","_parseExpr","join","RE_QBMARK","asText","mm","lv","ir","RE_BREND","RE_QBLOCK","div","cnt","CS_IDENT","jsb","rightContext","_wrapExpr","tb","JS_VARNAME","mvar","JS_CONTEXT","JS_NOPROPS","haveRaw","parse","checkIE","_mkdom","templ","replaceYield","tblTags","specialTags","select","selectedIndex","tname","rootEls","reHasYield","n","reYieldDest","def","rsYieldSrc","reYieldCls","reYieldAll","tr","th","td","col","styleManager","_riot","inject","styleNode","newNode","userNode","replaceChild","getElementsByTagName","cssTextProp","styleSheet","stylesToInject","css","cssText","w","raf","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","navigator","userAgent","lastTime","nowtime","timeout","Math","max","util","mixins","bpair","addRiotTags","selectAllTags","pushTags","riotTag","allTags","nodeList","_el","define","amd","store","fetchUser","user","about","fetchComments","fetchItems","kids","comments","fetchPollOptions","pollOptions","fetchItem","page","fetchNews","fetchItemsByPage","displayPage","removeListener","api","Firebase","storiesPerPage","cachedStoryIds","Emitter","EventEmitter","snapshot","once","ids","addItem","end","itemdata","showInfo","showDomain","open","commentcontent","text","result","_events","_maxListeners","isNumber","isUndefined","defaultMaxListeners","setMaxListeners","isNaN","TypeError","er","listeners","error","addListener","listener","newListener","warned","console","trace","g","fired","position","removeAllListeners","ret","listenerCount","evlistener","emitter"],"mappings":"AAAA;AWqBA,QAAS0f,gBACPne,KAAKgf,QAAUhf,KAAKgf,YACpBhf,KAAKif,cAAgBjf,KAAKif,eAAiBpe,OAoQ7C,QAAS2I,YAAW4K,GAClB,MAAsB,kBAARA,GAGhB,QAAS8K,UAAS9K,GAChB,MAAsB,gBAARA,GAGhB,QAASnL,UAASmL,GAChB,MAAsB,gBAARA,IAA4B,OAARA,EAGpC,QAAS+K,aAAY/K,GACnB,MAAe,UAARA,EA/QTzU,OAAOC,QAAUue,aAGjBA,aAAaA,aAAeA,aAE5BA,aAAa1U,UAAUuV,QAAUne,OACjCsd,aAAa1U,UAAUwV,cAAgBpe,OAIvCsd,aAAaiB,oBAAsB,GAInCjB,aAAa1U,UAAU4V,gBAAkB,SAAStF,GAChD,IAAKmF,SAASnF,IAAU,EAAJA,GAASuF,MAAMvF,GACjC,KAAMwF,WAAU,8BAElB,OADAvf,MAAKif,cAAgBlF,EACd/Z,MAGTme,aAAa1U,UAAUmH,KAAO,SAAS7J,GACrC,GAAIyY,GAAI5U,EAAS1H,EAAKwK,EAAMlM,EAAGie,CAM/B,IAJKzf,KAAKgf,UACRhf,KAAKgf,YAGM,UAATjY,KACG/G,KAAKgf,QAAQU,OACbzW,SAASjJ,KAAKgf,QAAQU,SAAW1f,KAAKgf,QAAQU,MAAMje,QAAS,CAEhE,GADA+d,EAAKpW,UAAU,GACXoW,YAAclK,OAChB,KAAMkK,EAER,MAAMD,WAAU,wCAMpB,GAFA3U,EAAU5K,KAAKgf,QAAQjY,GAEnBoY,YAAYvU,GACd,OAAO,CAET,IAAIpB,WAAWoB,GACb,OAAQxB,UAAU3H,QAEhB,IAAK,GACHmJ,EAAQd,KAAK9J,KACb,MACF,KAAK,GACH4K,EAAQd,KAAK9J,KAAMoJ,UAAU,GAC7B,MACF,KAAK,GACHwB,EAAQd,KAAK9J,KAAMoJ,UAAU,GAAIA,UAAU,GAC3C,MAEF,SACEsE,EAAOG,MAAMpE,UAAUzD,MAAM8D,KAAKV,UAAW,GAC7CwB,EAAQ8E,MAAM1P,KAAM0N,OAEnB,IAAIzE,SAAS2B,GAIlB,IAHA8C,EAAOG,MAAMpE,UAAUzD,MAAM8D,KAAKV,UAAW,GAC7CqW,EAAY7U,EAAQ5E,QACpB9C,EAAMuc,EAAUhe,OACXD,EAAI,EAAO0B,EAAJ1B,EAASA,IACnBie,EAAUje,GAAGkO,MAAM1P,KAAM0N,EAG7B,QAAO,GAGTyQ,aAAa1U,UAAUkW,YAAc,SAAS5Y,EAAM6Y,GAClD,GAAI1R,EAEJ,KAAK1E,WAAWoW,GACd,KAAML,WAAU,8BA2ClB,OAzCKvf,MAAKgf,UACRhf,KAAKgf,YAIHhf,KAAKgf,QAAQa,aACf7f,KAAK4Q,KAAK,cAAe7J,EACfyC,WAAWoW,EAASA,UACpBA,EAASA,SAAWA,GAE3B5f,KAAKgf,QAAQjY,GAGTkC,SAASjJ,KAAKgf,QAAQjY,IAE7B/G,KAAKgf,QAAQjY,GAAM/D,KAAK4c,GAGxB5f,KAAKgf,QAAQjY,IAAS/G,KAAKgf,QAAQjY,GAAO6Y,GAN1C5f,KAAKgf,QAAQjY,GAAQ6Y,EASnB3W,SAASjJ,KAAKgf,QAAQjY,MAAW/G,KAAKgf,QAAQjY,GAAM+Y,SAIpD5R,EAHGiR,YAAYnf,KAAKif,eAGhBd,aAAaiB,oBAFbpf,KAAKif,cAKP/Q,GAAKA,EAAI,GAAKlO,KAAKgf,QAAQjY,GAAMtF,OAASyM,IAC5ClO,KAAKgf,QAAQjY,GAAM+Y,QAAS,EAC5BC,QAAQL,MAAM,mIAGA1f,KAAKgf,QAAQjY,GAAMtF,QACJ,kBAAlBse,SAAQC,OAEjBD,QAAQC,UAKPhgB,MAGTme,aAAa1U,UAAU9I,GAAKwd,aAAa1U,UAAUkW,YAEnDxB,aAAa1U,UAAU4U,KAAO,SAAStX,EAAM6Y,GAM3C,QAASK,KACPjgB,KAAK6d,eAAe9W,EAAMkZ,GAErBC,IACHA,GAAQ,EACRN,EAASlQ,MAAM1P,KAAMoJ,YAVzB,IAAKI,WAAWoW,GACd,KAAML,WAAU,8BAElB,IAAIW,IAAQ,CAcZ,OAHAD,GAAEL,SAAWA,EACb5f,KAAKW,GAAGoG,EAAMkZ,GAEPjgB,MAITme,aAAa1U,UAAUoU,eAAiB,SAAS9W,EAAM6Y,GACrD,GAAI/H,GAAMsI,EAAU1e,EAAQD,CAE5B,KAAKgI,WAAWoW,GACd,KAAML,WAAU,8BAElB,KAAKvf,KAAKgf,UAAYhf,KAAKgf,QAAQjY,GACjC,MAAO/G,KAMT,IAJA6X,EAAO7X,KAAKgf,QAAQjY,GACpBtF,EAASoW,EAAKpW,OACd0e,EAAW,GAEPtI,IAAS+H,GACRpW,WAAWqO,EAAK+H,WAAa/H,EAAK+H,WAAaA,QAC3C5f,MAAKgf,QAAQjY,GAChB/G,KAAKgf,QAAQnB,gBACf7d,KAAK4Q,KAAK,iBAAkB7J,EAAM6Y,OAE/B,IAAI3W,SAAS4O,GAAO,CACzB,IAAKrW,EAAIC,EAAQD,KAAM,GACrB,GAAIqW,EAAKrW,KAAOoe,GACX/H,EAAKrW,GAAGoe,UAAY/H,EAAKrW,GAAGoe,WAAaA,EAAW,CACvDO,EAAW3e,CACX,OAIJ,GAAe,EAAX2e,EACF,MAAOngB,KAEW,KAAhB6X,EAAKpW,QACPoW,EAAKpW,OAAS,QACPzB,MAAKgf,QAAQjY,IAEpB8Q,EAAKlW,OAAOwe,EAAU,GAGpBngB,KAAKgf,QAAQnB,gBACf7d,KAAK4Q,KAAK,iBAAkB7J,EAAM6Y,GAGtC,MAAO5f,OAGTme,aAAa1U,UAAU2W,mBAAqB,SAASrZ,GACnD,GAAI/F,GAAKye,CAET,KAAKzf,KAAKgf,QACR,MAAOhf,KAGT,KAAKA,KAAKgf,QAAQnB,eAKhB,MAJyB,KAArBzU,UAAU3H,OACZzB,KAAKgf,WACEhf,KAAKgf,QAAQjY,UACb/G,MAAKgf,QAAQjY,GACf/G,IAIT,IAAyB,IAArBoJ,UAAU3H,OAAc,CAC1B,IAAKT,IAAOhB,MAAKgf,QACH,mBAARhe,GACJhB,KAAKogB,mBAAmBpf,EAI1B,OAFAhB,MAAKogB,mBAAmB,kBACxBpgB,KAAKgf,WACEhf,KAKT,GAFAyf,EAAYzf,KAAKgf,QAAQjY,GAErByC,WAAWiW,GACbzf,KAAK6d,eAAe9W,EAAM0Y,OACrB,IAAIA,EAET,KAAOA,EAAUhe,QACfzB,KAAK6d,eAAe9W,EAAM0Y,EAAUA,EAAUhe,OAAS,GAI3D,cAFOzB,MAAKgf,QAAQjY,GAEb/G,MAGTme,aAAa1U,UAAUgW,UAAY,SAAS1Y,GAC1C,GAAIsZ,EAOJ,OAHEA,GAHGrgB,KAAKgf,SAAYhf,KAAKgf,QAAQjY,GAE1ByC,WAAWxJ,KAAKgf,QAAQjY,KACxB/G,KAAKgf,QAAQjY,IAEd/G,KAAKgf,QAAQjY,GAAMf,YAI7BmY,aAAa1U,UAAU6W,cAAgB,SAASvZ,GAC9C,GAAI/G,KAAKgf,QAAS,CAChB,GAAIuB,GAAavgB,KAAKgf,QAAQjY,EAE9B,IAAIyC,WAAW+W,GACb,MAAO,EACJ,IAAIA,EACP,MAAOA,GAAW9e,OAEtB,MAAO,IAGT0c,aAAamC,cAAgB,SAASE,EAASzZ,GAC7C,MAAOyZ,GAAQF,cAAcvZ;;CPtR9B,SAAUjI,EAAQ+B,GACjB,YAohCF,SAASC,GAAOC,EAAMC,EAAKC,GACzB,GAAIC,KAGJ,OAFAA,GAAKH,EAAKC,KAAOA,EACbD,EAAKI,MAAKD,EAAKH,EAAKI,KAAOF,GACxBC,EAQT,QAASE,GAAiBC,EAAOC,GAM/B,IAJA,GAEEC,GAFEC,EAAIF,EAAKG,OACXC,EAAIL,EAAMI,OAGLD,EAAIE,GACTH,EAAID,IAAOE,GACXF,EAAKK,OAAOH,EAAG,GACfD,EAAElB,UASN,QAASuB,GAAeC,EAAOL,GAC7BM,OAAOC,KAAKF,EAAMP,MAAMU,QAAQ,SAASC,GACvC,GAAIC,GAAML,EAAMP,KAAKW,EACjBE,GAAQD,GACVE,EAAKF,EAAK,SAAUX,GAClBc,EAAad,EAAGU,EAAST,KAG3Ba,EAAaH,EAAKD,EAAST,KAUjC,QAASc,GAAWJ,EAAKK,EAAKC,GAC5B,GAAoBC,GAAhBC,EAAKR,EAAIS,KAEb,KADAT,EAAIU,UACGF,GACLD,EAAMC,EAAGG,YACLL,EACFD,EAAIO,aAAaJ,EAAIF,EAAOG,OAE5BJ,EAAIQ,YAAYL,GAElBR,EAAIU,OAAOI,KAAKN,GAChBA,EAAKD,EAWT,QAASQ,GAAYf,EAAKK,EAAKC,EAAQU,GAErC,IADA,GAAoBT,GAAhBC,EAAKR,EAAIS,MAAYnB,EAAI,EAClB0B,EAAJ1B,EAASA,IACdiB,EAAMC,EAAGG,YACTN,EAAIO,aAAaJ,EAAIF,EAAOG,OAC5BD,EAAKD,EAWT,QAASU,GAAMC,EAAKC,EAAQtC,GAG1BuC,EAAQF,EAAK,OAEb,IAUEG,GAVEC,QAAqBC,GAAQL,EAAK,gBAAkBM,GAAYJ,EAAQF,EAAK,cAC/EnB,EAAU0B,EAAWP,GACrBQ,EAAOC,EAAU5B,KAAc6B,KAAMV,EAAIW,WACzCC,EAAUC,GAAmBC,KAAKjC,GAClCkC,EAAOf,EAAIgB,WACXC,EAAMzF,SAAS0F,eAAe,IAC9BzC,EAAQ0C,EAAOnB,GACfoB,EAAW,YAAYN,KAAKjC,GAC5BX,KACAmD,KAEAC,EAA2B,WAAftB,EAAInB,OAGlBlB,GAAO+C,GAAKa,SAAS5D,GAGrBoD,EAAKrB,aAAauB,EAAKjB,GAGvBC,EAAOuB,IAAI,eAAgB,WAGzBxB,EAAIgB,WAAWS,YAAYzB,GACvBe,EAAKW,OAAMX,EAAOd,EAAOc,QAE5BxD,GAAG,SAAU,WAEd,GAAIU,GAAQyC,GAAK/C,EAAKE,IAAKoC,GAEzB0B,EAAOnG,SAASoG,wBAKb7C,GAAQd,KACXkC,EAAUlC,IAAS,EACnBA,EAAQkC,EACNzB,OAAOC,KAAKV,GAAO4D,IAAI,SAAUjE,GAC/B,MAAOF,GAAOC,EAAMC,EAAKK,EAAML,SAQrC,KAHA,GAAIQ,GAAI,EACN0D,EAAc7D,EAAMI,OAEXyD,EAAJ1D,EAAiBA,IAAK,CAE3B,GACEN,GAAOG,EAAMG,GACb2D,EAAe3B,GAAetC,YAAgBY,UAAWyB,EACzD6B,EAASX,EAASY,QAAQnE,GAC1BC,GAAOiE,GAAUD,EAAeC,EAAS5D,EAEzCU,EAAMZ,EAAKH,EAEbD,IAAQqC,GAAWxC,EAAKC,IAAMF,EAAOC,EAAMG,EAAMM,GAAKN,GAInDiE,IAAiBjD,GAElBiD,KAAkBC,IAAWlD,GAG7BA,EAAM,GAAIoD,GAAI1B,GACZP,OAAQA,EACRkC,QAAQ,EACRC,UAAW3B,EAAU5B,GACrBkC,KAAMH,EAAUG,EAAOf,EAAIqC,YAC3BvE,KAAMA,GACLkC,EAAIsC,WAEPxD,EAAIxD,QACAgG,IAAWxC,EAAIS,MAAQT,EAAIiC,KAAKwB,YAEhCnE,GAAKF,EAAKG,QAAWH,EAAKE,IAOxBkD,EACFpC,EAAWJ,EAAKiC,EAAM7C,EAAKE,IACxB2C,EAAKrB,aAAaZ,EAAIiC,KAAM7C,EAAKE,GAAG2C,MACzCM,EAAS9C,OAAOH,EAAG,EAAGN,IATlBwD,EACFpC,EAAWJ,EAAK6C,GACbA,EAAKhC,YAAYb,EAAIiC,MAU5B7C,EAAKK,OAAOH,EAAG,EAAGU,GAClBf,EAAMK,GACDU,EAAI0D,OAAO1E,GAIhBC,IAAQK,GAAK2D,GACb7D,EAAKE,KAGDkD,EACFzB,EAAYf,EAAKiC,EAAM7C,EAAKE,GAAI4B,EAAIyC,WAAWpE,QAC5C0C,EAAKrB,aAAaZ,EAAIiC,KAAM7C,EAAKE,GAAG2C,MAErCpD,EAAKI,MACPe,EAAInB,EAAKI,KAAOK,GAElBF,EAAKK,OAAOH,EAAG,EAAGF,EAAKK,OAAOR,EAAK,GAAG,IAEtCsD,EAAS9C,OAAOH,EAAG,EAAGiD,EAAS9C,OAAOR,EAAK,GAAG,KAGzCU,GAASK,EAAIZ,MAAMM,EAAeM,EAAKV,IAK9CU,EAAI4D,MAAQ5E,EAEZ6E,EAAe7D,EAAK,UAAWmB,GAIjCjC,EAAiBC,EAAOC,GAGpBkD,EAAUL,EAAKpB,YAAYgC,GAC1BZ,EAAKrB,aAAaiC,EAAMV,GAOzBxC,IAAOwB,EAAO/B,KAAKW,GAAWX,GAGlCmD,EAAWpD,EAAM2E,UAoErB,QAASC,GAAmB9B,EAAMjC,EAAKgE,EAAWC,GAEhDC,EAAKjC,EAAM,SAASf,GAClB,GAAoB,GAAhBA,EAAIiD,SAAe,CAMrB,GALAjD,EAAImC,OAASnC,EAAImC,QACJnC,EAAIgB,YAAchB,EAAIgB,WAAWmB,QAAU9B,EAAQL,EAAK,QACrD,EAAI,EAGhB8C,EAAW,CACb,GAAIrE,GAAQ0C,EAAOnB,EAEfvB,KAAUuB,EAAImC,QAChBW,EAAUlD,KAAKsD,EAAazE,GAAQsC,KAAMf,EAAKC,OAAQnB,GAAMkB,EAAIsC,UAAWxD,IAG3EkB,EAAImC,SAAUY,GACjBI,EAASnD,EAAKlB,SAOtB,QAASsE,GAAiBrC,EAAMjC,EAAKuE,GAEnC,QAASC,GAAQtD,EAAKnC,EAAK0F,GACrB7C,GAAK8C,QAAQ3F,IACfwF,EAAYzD,KAAK6D,GAASzD,IAAKA,EAAKrC,KAAME,GAAO0F,IAIrDP,EAAKjC,EAAM,SAASf,GAClB,GACE0D,GADEC,EAAO3D,EAAIiD,QAKf,OADY,IAARU,GAAuC,SAA1B3D,EAAIgB,WAAWnC,SAAoByE,EAAQtD,EAAKA,EAAI4D,WACzD,GAARD,GAKJD,EAAOrD,EAAQL,EAAK,UAERD,EAAMC,EAAKlB,EAAK4E,IAAc,IAG1C1E,EAAKgB,EAAI6D,WAAY,SAASH,GAC5B,GAAII,GAAOJ,EAAKI,KACdC,EAAOD,EAAKE,MAAM,MAAM,EAG1B,OADAV,GAAQtD,EAAK0D,EAAKO,OAASP,KAAMK,GAAQD,EAAMC,KAAMA,IACjDA,GAAQ7D,EAAQF,EAAK8D,IAAc,GAAvC,SAKE3C,EAAOnB,IAAa,EAAxB,QApBA,SAyBJ,QAASkC,GAAI1B,EAAM0D,EAAM5B,GA6CvB,QAAS6B,KACP,GAAIC,GAAMhC,GAAWD,EAASxF,EAAOsD,GAAUtD,CAG/CqC,GAAK+B,EAAK8C,WAAY,SAASvE,GAC7B,GAAIzB,GAAMyB,EAAG2E,KACbvH,GAAK2H,EAAQ/E,EAAGwE,OAASpD,GAAK8C,QAAQ3F,GAAO6C,GAAK7C,EAAKuG,GAAOvG,IAGhEmB,EAAKN,OAAOC,KAAK+E,GAAO,SAASI,GAC/BpH,EAAK2H,EAAQP,IAASpD,GAAKgD,EAAKI,GAAOM,KAI3C,QAASE,GAAcpH,GACrB,IAAK,GAAIU,KAAOE,SACHnB,GAAKiB,KAAS2G,GAAWC,EAAW7H,EAAMiB,KACnDjB,EAAKiB,GAAOV,EAAKU,IAIvB,QAAS6G,KACF9H,EAAKsD,QAAWkC,GACrBnD,EAAKN,OAAOC,KAAKhC,EAAKsD,QAAS,SAASyE,GAEtC,GAAIC,IAAYC,EAASC,GAA0BH,IAAME,EAASE,EAAuBJ,UAC9E/H,GAAK+H,KAAOH,GAAWI,KAG3BA,GAAUG,EAAsBlF,KAAK8E,GAC1C/H,EAAK+H,GAAK/H,EAAKsD,OAAOyE,MAiL5B,QAASK,GAAOC,GAMd,GAHAhG,EAAK8D,EAAW,SAASrE,GAASA,EAAMuG,EAAU,QAAU,eAGvD/E,EAAL,CACA,GAAIgF,GAAMD,EAAU,KAAO,KAGvB7C,GACFlC,EAAOgF,GAAK,UAAWtI,EAAKM,SAE5BgD,EAAOgF,GAAK,SAAUtI,EAAK6F,QAAQyC,GAAK,UAAWtI,EAAKM,UAvQ5D,GAcE+C,GAdErD,EAAOL,EAAK4I,WAAWtI,MACzBF,EAAOyI,EAAQjB,EAAKxH,UACpBuD,EAASiE,EAAKjE,OACdkC,EAAS+B,EAAK/B,OACdC,EAAU8B,EAAK9B,QACftE,EAAOsH,EAAYlB,EAAKpG,MACxBuF,KACAP,KACA/B,EAAOmD,EAAKnD,KACZsE,EAAK7E,EAAK6E,GACVxG,EAAUkC,EAAKlC,QAAQyG,cACvB5B,KACA6B,KACAT,IAGEO,IAAMtE,EAAKyE,MAAMzE,EAAKyE,KAAKvI,SAAQ,GAGvCL,KAAK6I,WAAY,EACjB1E,EAAKoB,OAASA,EAIdpB,EAAKyE,KAAO5I,KAIZ+F,EAAe/F,KAAM,aAAc8I,GAEnCjC,EAAO7G,MAAQqD,OAAQA,EAAQc,KAAMA,EAAMrE,KAAMA,EAAMwB,SAAYJ,GAGnEkB,EAAK+B,EAAK8C,WAAY,SAASvE,GAC7B,GAAIzB,GAAMyB,EAAG2E,KAETvD,IAAK8C,QAAQ3F,KAAM6F,EAAKpE,EAAGwE,MAAQjG,KAGzCmC,EAAM2F,GAAMnF,EAAM8B,EAAWiD,GAC7BA,EAAWA,EAASK,OAAS,GAsC7BjD,EAAe/F,KAAM,SAAU,SAASM,GAyBtC,MArBAA,GAAOkI,EAAYlI,GAEnBuH,IAEIvH,GAAQ2I,EAAS/H,KACnBwG,EAAcpH,GACdY,EAAOZ,GAETuG,EAAO9G,EAAMO,GACbiH,IACAxH,EAAKmJ,QAAQ,SAAU5I,GACvBsF,EAAOa,EAAa1G,GAKhBA,EAAKsD,OAEPtD,EAAKsD,OAAOuB,IAAI,UAAW,WAAa7E,EAAKmJ,QAAQ,aAClDC,GAAI,WAAapJ,EAAKmJ,QAAQ,aAE5BlJ,OAGT+F,EAAe/F,KAAM,QAAS,WA0B5B,MAzBAoC,GAAKgH,UAAW,SAASC,GACvB,GAAIC,EAEJD,SAAaA,KAAQ3F,EAAWhE,EAAK6J,MAAMF,GAAOA,EAG9CG,EAAWH,IAEbC,EAAW,GAAID,GAEfA,EAAMA,EAAII,WACLH,EAAWD,EAGlBjH,EAAKN,OAAO4H,oBAAoBL,GAAM,SAASrI,GAElC,QAAPA,IACFjB,EAAKiB,GAAOwI,EAAWF,EAAStI,IAClBsI,EAAStI,GAAKT,KAAKR,GACnBuJ,EAAStI,MAIvBsI,EAASK,MAAML,EAASK,KAAKpJ,KAAKR,OAEjCC,OAGT+F,EAAe/F,KAAM,QAAS,WAE5BuH,GAGA,IAAIqC,GAAclK,EAAK6J,MAAMM,EAwB7B,IAvBID,GAAa7J,EAAKwJ,MAAMK,GAGxBnB,GAAIA,EAAGqB,KAAK/J,EAAMD,GAGtB0G,EAAiBpD,EAAKrD,EAAM0G,GAG5B0B,GAAO,IAIHQ,GAAYnD,KACduE,EAAepB,EAAU,SAAUb,EAAGkC,GAAKC,EAAQ9F,EAAM2D,EAAGkC,KAC5DxD,EAAiBzG,EAAKoE,KAAMpE,EAAM0G,IAG/B1G,EAAKsD,SAAUkC,GAAQxF,EAAK6F,OAAO1E,GAGxCnB,EAAKmJ,QAAQ,gBAET3D,IAAWC,EAEbrB,EAAOf,EAAIuC,eACN,CACL,KAAOvC,EAAIuC,YAAYxB,EAAKpB,YAAYK,EAAIuC,WACxCxB,GAAKW,OAAMX,EAAOd,EAAOc,MAG/B4B,EAAehG,EAAM,OAAQoE,GAIzBoB,GACFU,EAAmBlG,EAAKoE,KAAMpE,EAAKsD,OAAQ,MAAM,IAG9CtD,EAAKsD,QAAUtD,EAAKsD,OAAOwF,WAC9B9I,EAAK8I,WAAY,EACjB9I,EAAKmJ,QAAQ,UAGVnJ,EAAKsD,OAAOuB,IAAI,QAAS,WAGvBsF,EAASnK,EAAKoE,QACjBpE,EAAKsD,OAAOwF,UAAY9I,EAAK8I,WAAY,EACzC9I,EAAKmJ,QAAQ,cAMnBnD,EAAe/F,KAAM,UAAW,SAASmK,GACvC,GAEEC,GAFE1H,EAAKyB,EACPkG,EAAI3H,EAAG0B,WAEPkG,EAAWC,EAAalF,QAAQtF,EAclC,IAZAA,EAAKmJ,QAAQ,mBAGRoB,GACHC,EAAa5I,OAAO2I,EAAU,GAE5BtK,KAAK4C,QACPR,EAAKpC,KAAK4C,OAAQ,SAASoH,GACrBA,EAAE5F,YAAY4F,EAAE5F,WAAWS,YAAYmF,KAI3CK,EAAG,CAEL,GAAIhH,EACF+G,EAAOI,EAA4BnH,GAI/BlB,EAAQiI,EAAK9I,KAAKW,IACpBG,EAAKgI,EAAK9I,KAAKW,GAAU,SAASC,EAAKV,GACjCU,EAAIuI,UAAY1K,EAAK0K,UACvBL,EAAK9I,KAAKW,GAASN,OAAOH,EAAG,KAIjC4I,EAAK9I,KAAKW,GAAWpB,MAIvB,MAAO6B,EAAGiD,YAAYjD,EAAGmC,YAAYnC,EAAGiD,WAErCwE,GAIH7G,EAAQ+G,EAAG,YAHXA,EAAExF,YAAYnC,GAOlB3C,EAAKmJ,QAAQ,WACbf,IACApI,EAAK2K,IAAI,KACT3K,EAAK8I,WAAY,QACV1E,GAAKyE,OAqBd3C,EAAmB7C,EAAKpD,KAAMkG,GAUhC,QAASyE,GAAgBzD,EAAM0D,EAASxH,EAAKlB,GAE3CkB,EAAI8D,GAAQ,SAAS2D,GAEnB,GAEEnI,GAFE0H,EAAOlI,EAAI4I,QACb5J,EAAOgB,EAAI4D,KAGb,KAAK5E,EACH,KAAOkJ,IAASlJ,GACdA,EAAOkJ,EAAKtE,MACZsE,EAAOA,EAAKU,OAIhBD,GAAIA,GAAK/L,EAAOiM,MAGZnD,EAAWiD,EAAG,mBAAkBA,EAAEG,cAAgB5H,GAClDwE,EAAWiD,EAAG,YAAWA,EAAErI,OAASqI,EAAEI,YACtCrD,EAAWiD,EAAG,WAAUA,EAAEK,MAAQL,EAAEM,UAAYN,EAAEO,SAEtDP,EAAE3J,KAAOA,EAGL0J,EAAQd,KAAK5H,EAAK2I,MAAO,GAAS,cAAc3G,KAAKd,EAAI2D,QACvD8D,EAAEQ,gBAAgBR,EAAEQ,iBACxBR,EAAES,aAAc,GAGbT,EAAEU,gBACL7I,EAAKxB,EAAOsJ,EAA4BJ,GAAQlI,EAChDQ,EAAGkD,WAcT,QAAS4F,GAASrH,EAAMsH,EAAMC,GACvBvH,IACLA,EAAKrB,aAAa4I,EAAQD,GAC1BtH,EAAKU,YAAY4G,IAQnB,QAAS7F,GAAOa,EAAavE,GAE3BE,EAAKqE,EAAa,SAAS1F,EAAMS,GAE/B,GAAI4B,GAAMrC,EAAKqC,IACbuI,EAAW5K,EAAK+F,KAChBO,EAAQvD,GAAK/C,EAAKA,KAAMmB,GACxBmB,EAAStC,EAAKqC,IAAIgB,UAQpB,IANIrD,EAAKoG,KACPE,IAAUA,EACM,MAATA,IACPA,EAAQ,KAGLsE,EAYH,MATAtE,IAAS,QAELhE,GAAUD,EAAI4D,WAAaK,IACN,aAAnBhE,EAAOpB,SACToB,EAAOgE,MAAQA,EACVuE,KAAYxI,EAAI4D,UAAYK,IAE9BjE,EAAI4D,UAAYK,GAMzB,IAAiB,UAAbsE,EAEF,YADIvI,EAAIiE,OAASA,IAAOjE,EAAIiE,MAAQA,GAKtC,IAAItG,EAAKsG,QAAUA,EASnB,GANAtG,EAAKsG,MAAQA,EAGb/D,EAAQF,EAAKuI,GAGTnC,EAAWnC,GACbsD,EAAgBgB,EAAUtE,EAAOjE,EAAKlB,OAGjC,IAAgB,MAAZyJ,EAAkB,CAC3B,GAAI7G,GAAO/D,EAAK+D,KACd+G,EAAM,WAAaL,EAAS1G,EAAKV,WAAYU,EAAM1B,IACnD0I,EAAS,WAAaN,EAASpI,EAAIgB,WAAYhB,EAAK0B,GAGlDuC,GACEvC,IACF+G,IACAzI,EAAI2I,QAAS,EAGR7B,EAAS9G,IACZgD,EAAKhD,EAAK,SAASV,GACbA,EAAGkG,OAASlG,EAAGkG,KAAKC,YACtBnG,EAAGkG,KAAKC,YAAcnG,EAAGkG,KAAKM,QAAQ,cAM9CpE,EAAO/D,EAAK+D,KAAOA,GAAQlG,SAAS0F,eAAe,IAE/ClB,EAAIgB,WACN0H,KAEI5J,EAAImB,QAAUnB,GAAK0C,IAAI,UAAWkH,GAExC1I,EAAI2I,QAAS,OAGO,SAAbJ,EACTvI,EAAI4I,MAAMC,QAAU5E,EAAQ,GAAK,OAEX,SAAbsE,EACTvI,EAAI4I,MAAMC,QAAU5E,EAAQ,OAAS,GAE5BtG,EAAKoG,KACVE,IAEe,aAAbsE,GAA4C,WAAjBvI,EAAI8I,UAAyB7I,IAC1DA,EAAOgE,MAAQjE,EAAIiE,OAErB4C,EAAQ7G,EAAKuI,EAAUA,KAGN,IAAVtE,GAAeA,SAAgBA,KAAU8E,KAE9CC,EAAWT,EAAUU,IAAgBV,GAAYW,IACnDX,EAAWA,EAAS3F,MAAMqG,EAAY5K,SAExCwI,EAAQ7G,EAAKuI,EAAUtE,MAY7B,QAASjF,GAAKmK,EAAK9D,GAGjB,IAAK,GAAW/F,GAFZQ,EAAMqJ,EAAMA,EAAI9K,OAAS,EAEpBD,EAAI,EAAW0B,EAAJ1B,EAASA,IAC3BkB,EAAK6J,EAAI/K,GAEC,MAANkB,GAAc+F,EAAG/F,EAAIlB,MAAO,GAAOA,GAEzC,OAAO+K,GAQT,QAAS/C,GAAWQ,GAClB,aAAcA,KAAMwC,KAAc,EASpC,QAASvD,GAASe,GAChB,MAAOA,UAAYA,KAAMmC,EAQ3B,QAAS7I,GAAQF,EAAK8D,GACpB9D,EAAIqJ,gBAAgBvF,GAQtB,QAASO,GAAQiF,GACf,MAAOA,GAAOC,QAAQ,SAAU,SAASC,EAAGC,GAC1C,MAAOA,GAAEC,gBAUb,QAASrJ,GAAQL,EAAK8D,GACpB,MAAO9D,GAAI2J,aAAa7F,GAS1B,QAAS+C,GAAQ7G,EAAK8D,EAAMjG,GAC1BmC,EAAI4J,aAAa9F,EAAMjG,GAQzB,QAASsD,GAAOnB,GACd,MAAOA,GAAInB,SAAW4B,EAAUJ,EAAQL,EAAKkJ,IAAalJ,EAAInB,QAAQyG,eAQxE,QAASuE,GAAY/K,EAAKD,EAASoB,GACjC,GAAI6J,GAAY7J,EAAO/B,KAAKW,EAGxBiL,IAGG/K,EAAQ+K,IAEPA,IAAchL,IAChBmB,EAAO/B,KAAKW,IAAYiL,IAEvBlF,EAAS3E,EAAO/B,KAAKW,GAAUC,IAClCmB,EAAO/B,KAAKW,GAASe,KAAKd,IAE5BmB,EAAO/B,KAAKW,GAAWC,EAU3B,QAASG,GAAaH,EAAKD,EAASkL,GAClC,GACE7L,GADE+B,EAASnB,EAAImB,MAGZA,KAEL/B,EAAO+B,EAAO/B,KAAKW,GAEfE,EAAQb,GACVA,EAAKK,OAAOwL,EAAQ,EAAG7L,EAAKK,OAAOL,EAAK+D,QAAQnD,GAAM,GAAG,IACtD+K,EAAY/K,EAAKD,EAASoB,IAWjC,QAASiD,GAAazE,EAAO/B,EAAM4F,EAAWrC,GAC5C,GAAInB,GAAM,GAAIoD,GAAIzD,EAAO/B,EAAM4F,GAC7BzD,EAAU0B,EAAW7D,EAAKqE,MAC1BiG,EAAOI,EAA4BnH,EAiBrC,OAfAnB,GAAImB,OAAS+G,EAIblI,EAAI4I,QAAUzH,EAGd4J,EAAY/K,EAAKD,EAASmI,GAEtBA,IAAS/G,GACX4J,EAAY/K,EAAKD,EAASoB,GAG5BvD,EAAKqE,KAAKuB,UAAY,GAEfxD,EAQT,QAASsI,GAA4BtI,GAEnC,IADA,GAAIkI,GAAOlI,GACHqC,EAAO6F,EAAKjG,OACbiG,EAAK/G,QACV+G,EAAOA,EAAK/G,MAEd,OAAO+G,GAWT,QAASrE,GAAerD,EAAI1B,EAAKqG,EAAO+F,GAOtC,MANAtL,QAAOiE,eAAerD,EAAI1B,EAAK6F,GAC7BQ,MAAOA,EACPgG,YAAY,EACZC,UAAU,EACVC,cAAc,GACbH,IACI1K,EAQT,QAASiB,GAAWP,GAClB,GAAIvB,GAAQ0C,EAAOnB,GACjBoK,EAAW/J,EAAQL,EAAK,QACxBnB,EAAUuL,IAAa1J,GAAK8C,QAAQ4G,GACxBA,EACF3L,EAAQA,EAAMqF,KAAO9D,EAAInB,QAAQyG,aAE7C,OAAOzG,GAaT,QAAS4E,GAAOtE,GAEd,IAAK,GADDkL,GAAKC,EAAOtE,UACP5H,EAAI,EAAGA,EAAIkM,EAAKjM,SAAUD,EACjC,GAAIiM,EAAMC,EAAKlM,GACb,IAAK,GAAIR,KAAOyM,GAEV7F,EAAWrF,EAAKvB,KAClBuB,EAAIvB,GAAOyM,EAAIzM,GAIvB,OAAOuB,GAST,QAASyF,GAAS2F,EAAKzM,GACrB,OAAQyM,EAAItI,QAAQnE,GAQtB,QAASiB,GAAQyL,GAAK,MAAOC,OAAM1L,QAAQyL,IAAMA,YAAaC,OAQ9D,QAASjG,GAAW6F,EAAKzM,GACvB,GAAI8M,GAAQhM,OAAOiM,yBAAyBN,EAAKzM,EACjD,cAAcyM,GAAIzM,KAAS2G,GAAWmG,GAASA,EAAMR,SASvD,QAAS9E,GAAYlI,GACnB,KAAMA,YAAgBgF,IAAUhF,SAAeA,GAAK4I,SAAWsD,IAC7D,MAAOlM,EAET,IAAI0N,KACJ,KAAK,GAAIhN,KAAOV,GACT0H,EAASC,GAA0BjH,KACtCgN,EAAEhN,GAAOV,EAAKU,GAElB,OAAOgN,GAQT,QAAS5H,GAAKhD,EAAKqF,GACjB,GAAIrF,EAAK,CAEP,GAAIqF,EAAGrF,MAAS,EAAO,MAIrB,KAFAA,EAAMA,EAAIuC,WAEHvC,GACLgD,EAAKhD,EAAKqF,GACVrF,EAAMA,EAAIP,aAWlB,QAASkH,GAAekE,EAAMxF,GAI5B,IAHA,GAAIyF,GACFC,EAAK,gDAEAD,EAAIC,EAAGC,KAAKH,IACjBxF,EAAGyF,EAAE,GAAGxF,cAAewF,EAAE,IAAMA,EAAE,IAAMA,EAAE,IAS7C,QAAShE,GAAS9G,GAChB,KAAOA,GAAK,CACV,GAAIA,EAAI2I,OAAQ,OAAO,CACvB3I,GAAMA,EAAIgB,WAEZ,OAAO,EAQT,QAASiK,GAAKnH,GACZ,MAAOtI,UAASC,cAAcqI,GAShC,QAASoH,GAAGC,EAAU/G,GACpB,OAAQA,GAAO5I,UAAU4P,iBAAiBD,GAS5C,QAASE,GAAEF,EAAU/G,GACnB,OAAQA,GAAO5I,UAAU8P,cAAcH,GAQzC,QAAShG,GAAQlF,GACf,QAASsL,MAET,MADAA,GAAMlF,UAAYpG,EACX,GAAIsL,GAQb,QAASC,GAAYxL,GACnB,MAAOK,GAAQL,EAAK,OAASK,EAAQL,EAAK,QAS5C,QAASmD,GAASnD,EAAKC,EAAQtB,GAE7B,GACE8M,GADE7N,EAAM4N,EAAYxL,GAGpByI,EAAM,SAASxE,GAETW,EAASjG,EAAMf,KAEnB6N,EAAQ1M,EAAQkF,GAEXA,IAIKwH,GAASA,IAAU7G,EAASX,EAAOjE,MAEvCyL,EACFxH,EAAMrE,KAAKI,GAEXC,EAAOrC,IAAQqG,EAAOjE,IAPxBC,EAAOrC,GAAOoC,GAYfpC,KAGD8C,GAAK8C,QAAQ5F,GAEfqC,EAAOuB,IAAI,QAAS,WAClB5D,EAAM4N,EAAYxL,GAClByI,EAAIxI,EAAOrC,MAGb6K,EAAIxI,EAAOrC,KAUf,QAASoL,GAAW7J,EAAKuM,GACvB,MAAOvM,GAAIyD,MAAM,EAAG8I,EAAIrN,UAAYqN,EA8BtC,QAASC,GAAQ5K,EAAMlC,EAASnC,GAC9B,GAAIoC,GAAM2B,EAAU5B,GAElByD,EAAYvB,EAAK6K,WAAa7K,EAAK6K,YAAc7K,EAAKuB,SAaxD,OAVAvB,GAAKuB,UAAY,GAEbxD,GAAOiC,IAAMjC,EAAM,GAAIoD,GAAIpD,GAAOiC,KAAMA,EAAMrE,KAAMA,GAAQ4F,IAE5DxD,GAAOA,EAAIxD,QACbwD,EAAIxD,QAECsJ,EAASuC,EAAcrI,IAAMqI,EAAavH,KAAKd,IAG/CA,EA3wET,GAAIxC,IAASuP,QAAS,UAAWC,aAK/BpG,EAAQ,EAERyB,KAEA1G,KAKAgG,EAAe,iBAGfwC,EAAc,QACdC,EAAWD,EAAc,MAGzB3I,EAAW,SACXyI,EAAW,SACXxE,EAAW,YACX6E,GAAa,WAEbvI,GAAqB,yEACrBgE,IAA4B,QAAS,MAAO,UAAW,SAAU,OAAQ,QAAS,UAAW,QAAS,YAAa,SAAU,OAAQ,SAAU,OAAQ,UAAW,KAAM,MAAO,OAG/K2D,GAA8D,GAAhD9M,GAAUA,EAAOF,cAAgBuQ,YAEjDzP,GAAK4I,WAAa,SAAS5F,GAOzBA,EAAKA,KAKL,IAAI0M,MACFpJ,EAAQ6H,MAAMpE,UAAUzD,MACxBqJ,EAAc,SAASxE,EAAGpC,GAAMoC,EAAE8B,QAAQ,OAAQlE,GAiHpD,OA9GA3G,QAAOwN,iBAAiB5M,GAOtB/B,IACE0G,MAAO,SAASkI,EAAQ9G,GACtB,MAAiB,kBAANA,GAA0B/F,GAErC2M,EAAYE,EAAQ,SAASrI,EAAM/F,IAChCiO,EAAUlI,GAAQkI,EAAUlI,QAAalE,KAAKyF,GAC/CA,EAAG+G,MAAQrO,EAAM,IAGZuB,IAET2K,YAAY,EACZC,UAAU,EACVC,cAAc,GAShB7C,KACErD,MAAO,SAASkI,EAAQ9G,GAYtB,MAXc,KAAV8G,GAAkB9G,EAEpB4G,EAAYE,EAAQ,SAASrI,GAC3B,GAAIuB,EAEF,IAAK,GAAWgH,GADZ9B,EAAMyB,EAAUlI,GACX1F,EAAI,EAAOiO,EAAK9B,GAAOA,EAAInM,KAAMA,EACpCiO,GAAMhH,GAAIkF,EAAIhM,OAAOH,IAAK,cAEpB4N,GAAUlI,KARFkI,KAWnB1M,GAET2K,YAAY,EACZC,UAAU,EACVC,cAAc,GAShB3I,KACEyC,MAAO,SAASkI,EAAQ9G,GACtB,QAAS9H,KACP+B,EAAGgI,IAAI6E,EAAQ5O,GACf8H,EAAGiH,MAAMhN,EAAI0G,WAEf,MAAO1G,GAAG/B,GAAG4O,EAAQ5O,IAEvB0M,YAAY,EACZC,UAAU,EACVC,cAAc,GAQhBrE,SACE7B,MAAO,SAASkI,GAOd,IAAK,GAFHI,GAFEC,EAASxG,UAAU3H,OAAS,EAC9BiM,EAAO,GAAIG,OAAM+B,GAGVpO,EAAI,EAAOoO,EAAJpO,EAAYA,IAC1BkM,EAAKlM,GAAK4H,UAAU5H,EAAI,EAoB1B,OAjBA6N,GAAYE,EAAQ,SAASrI,GAE3ByI,EAAM3J,EAAM8D,KAAKsF,EAAUlI,OAAa,EAExC,KAAK,GAAWuB,GAAPjH,EAAI,EAAOiH,EAAKkH,EAAInO,KAAMA,EAAG,CACpC,GAAIiH,EAAGoH,KAAM,MACbpH,GAAGoH,KAAO,EACVpH,EAAGiH,MAAMhN,EAAI+F,EAAG+G,OAAStI,GAAM4I,OAAOpC,GAAQA,GAC1CiC,EAAInO,KAAOiH,GAAMjH,IACrBiH,EAAGoH,KAAO,EAGRT,EAAU,MAAgB,KAARlI,GACpBxE,EAAGwG,QAAQwG,MAAMhN,GAAK,IAAKwE,GAAM4I,OAAOpC,MAIrChL,GAET2K,YAAY,EACZC,UAAU,EACVC,cAAc,KAIX7K,GAIR,SAAUhD,GAmCX,QAASqQ,GAAeC,GACtB,MAAOA,GAAK5I,MAAM,UASpB,QAAS6I,GAAsBD,EAAME,GACnC,GAAI/B,GAAK,GAAIgC,QAAO,IAAMD,EAAOE,GAAS,MAAO,cAAcA,GAAS,OAAQ,MAAQ,KACtF1C,EAAOsC,EAAKK,MAAMlC,EAEpB,OAAIT,GAAaA,EAAK1H,MAAM,GAA5B,OASF,QAASsK,GAAS7H,EAAI8H,GACpB,GAAIhP,EACJ,OAAO,YACLiP,aAAajP,GACbA,EAAIkP,WAAWhI,EAAI8H,IAQvB,QAAS3P,GAAM8P,GACbC,EAAgBL,EAASM,EAAM,GAC/BC,EAAIC,GAAoBC,EAAUJ,GAClCE,EAAIC,GAAoBE,EAAYL,GACpCM,EAAIH,GAAoBI,EAAYC,GAChCT,GAAUE,GAAK,GAMrB,QAASQ,KACPpR,KAAKyO,KACL/O,EAAK4I,WAAWtI,MAChBqR,EAAQ1Q,GAAG,OAAQX,KAAKsR,EAAE/Q,KAAKP,OAC/BqR,EAAQ1Q,GAAG,OAAQX,KAAK6K,EAAEtK,KAAKP,OAGjC,QAASuR,GAAUvB,GACjB,MAAOA,GAAKI,GAAS,UAAW,IAGlC,QAASoB,GAAS1C,GAChB,MAAqB,gBAAPA,GAQhB,QAAS2C,GAAgBjS,GACvB,OAAQA,GAAQkS,EAAIlS,MAAQ,IAAI4Q,GAASuB,EAAW,IAQtD,QAASC,GAAgBpS,GACvB,MAAkB,KAAXqS,EAAK,IACPrS,GAAQkS,EAAIlS,MAAQ,IAAI4H,MAAMyK,GAAM,IAAM,GAC3CJ,EAAgBjS,GAAM4Q,GAASyB,EAAM,IAG3C,QAASjB,GAAKkB,GAEZ,GAAIC,GAA2B,GAAlBC,CACb,MAA4BA,GAAxBC,KAEJD,IACAE,EAAUlP,KAAK,WACb,GAAIgN,GAAO4B,KACPE,GAAS9B,GAAQmC,KACnBd,EAAQe,GAAS,OAAQpC,GACzBmC,EAAUnC,KAGV+B,GAAQ,CACV,KAAOG,EAAUzQ,QACfyQ,EAAU,KACVA,EAAUG,OAEZL,GAAiB,GAIrB,QAASb,GAAMtG,GACb,KACa,GAAXA,EAAEK,OACCL,EAAEyH,SAAWzH,EAAE0H,SAAW1H,EAAE2H,UAC5B3H,EAAE4H,kBAHP,CAOA,IADA,GAAI/P,GAAKmI,EAAErI,OACJE,GAAqB,KAAfA,EAAGwJ,UAAiBxJ,EAAKA,EAAG0B,YAEtC1B,GAAqB,KAAfA,EAAGwJ,UACPxJ,EAAGgQ,GAAe,cACjBhQ,EAAGgQ,GAAe,SACnBhQ,EAAGF,QAAuB,SAAbE,EAAGF,QACiC,IAAjDE,EAAGlD,KAAK6F,QAAQqM,EAAIlS,KAAK6Q,MAAMsB,GAAW,MAG3CjP,EAAGlD,MAAQkS,EAAIlS,MAEfkD,EAAGlD,KAAK4H,MAAM,KAAK,IAAMsK,EAAIlS,KAAK4H,MAAM,KAAK,KAClC,KAARyK,GAA0D,IAA3CJ,EAAgB/O,EAAGlD,MAAM6F,QAAQwM,KAC/Cc,EAAGf,EAAgBlP,EAAGlD,MAAOkD,EAAGkQ,OAAS3B,EAAI2B,SAIrD/H,EAAEQ,kBAUJ,QAASsH,GAAG3C,EAAM4C,EAAOC,GACvB,MAAIC,IACF9C,EAAO6B,EAAON,EAAUvB,GACxB4C,EAAQA,GAAS3B,EAAI2B,MAErBC,EACIC,EAAKC,aAAa,KAAMH,EAAO5C,GAC/B8C,EAAKE,UAAU,KAAMJ,EAAO5C,GAEhCiB,EAAI2B,MAAQA,EACZK,GAAa,EACbrC,IACOqC,GAIF5B,EAAQe,GAAS,OAAQR,EAAgB5B,IArLlD,GAmBEW,GACAkB,EAAMM,EAASxT,EAAQuU,EApBrBvB,EAAY,gBACdwB,EAAiB,gBACjBC,EAAwB,SAAWD,EACnCrC,EAAqB,MAAQqC,EAC7BT,EAAgB,eAChBtC,EAAU,UACVW,EAAW,WACXC,EAAa,aACboB,EAAU,UACVH,EAAuB,EACvBpB,EAAuB,mBAAV/R,IAAyBA,EACtCmS,EAAyB,mBAAZrS,WAA2BA,SACxCkU,EAAOjC,GAAOwC,QACd3B,EAAMb,IAAQiC,EAAKQ,UAAYzC,EAAIyC,UACnCC,EAAOnC,EAAO3H,UACdyH,EAAaD,GAAOA,EAAIuC,aAAe,aAAe,QACtDC,GAAU,EACVpC,EAAU3R,EAAK4I,aACf2K,GAAa,EAEwBf,KAAgBF,EAAiB,CA+KxEuB,GAAKrF,EAAI,SAASwF,EAAOC,EAAQC,IAC3BpC,EAASkC,IAAYC,IAAUnC,EAASmC,GACnCA,EAAQ3T,KAAK6T,EAAEH,EAAOC,GAC1B3T,KAAK6T,EAAE,IAAKH,GAFqCf,EAAGe,EAAOC,EAAQC,IAAS,IAQnFL,EAAKjC,EAAI,WACPtR,KAAK0K,IAAI,KACT1K,KAAKyO,MAOP8E,EAAK1I,EAAI,SAASmF,GAChBhQ,KAAKyO,EAAEqB,OAAO,KAAKgE,KAAK,SAAS5D,GAC/B,GAAIxC,IAAkB,KAAVwC,EAAgBvR,EAASuU,GAAc3B,EAAUvB,GAAOuB,EAAUrB,GAC9E,OAAmB,mBAARxC,IACT1N,KAAKoS,GAAS1C,MAAM,MAAOQ,GAAQJ,OAAOpC,IACnCuF,GAAa,GAFtB,QAICjT,OAQLuT,EAAKM,EAAI,SAAS3D,EAAQ6D,GACV,KAAV7D,IACFA,EAAS,IAAMqB,EAAUrB,GACzBlQ,KAAKyO,EAAEzL,KAAKkN,IAEdlQ,KAAKW,GAAGuP,EAAQ6D,GAGlB,IAAIC,GAAa,GAAI5C,GACjB1Q,EAAQsT,EAAW9F,EAAE3N,KAAKyT,EAM9BtT,GAAMuT,OAAS,WACb,GAAIC,GAAe,GAAI9C,EAIvB,OAFA8C,GAAahG,EAAEiG,KAAOD,EAAa5C,EAAE/Q,KAAK2T,GAEnCA,EAAahG,EAAE3N,KAAK2T,IAO7BxT,EAAMmR,KAAO,SAASuC,GACpBvC,EAAOuC,GAAO,IACdjC,EAAUP,KAIZlR,EAAM0N,KAAO,WACXwC,GAAK,IAQPlQ,EAAM/B,OAAS,SAAS8J,EAAI4L,GACrB5L,GAAO4L,IAEV1V,EAASoR,EACTmD,EAAejD,GAEbxH,IAAI9J,EAAS8J,GACb4L,IAAKnB,EAAemB,IAO1B3T,EAAM4T,MAAQ,WACZ,GAAIC,MACA/U,EAAOkS,EAAIlS,MAAQ2S,CAEvB,OADA3S,GAAK4Q,GAAS,qBAAsB,SAASxD,EAAG9E,EAAGkC,GAAKuK,EAAEzM,GAAKkC,IACxDuK,GAIT7T,EAAMyT,KAAO,WACPV,IACE5C,IACFA,EAAIuC,GAAuBrC,EAAUJ,GACrCE,EAAIuC,GAAuBpC,EAAYL,GACvCM,EAAImC,GAAuBlC,EAAYC,IAEzCE,EAAQe,GAAS,QACjBqB,GAAU,IAQd/S,EAAME,MAAQ,SAAU8P,GACjB+C,IACC5C,IACyB,YAAvBjS,SAAS4V,WAA0B5T,EAAM8P,GAGxCG,EAAIC,GAAoB,OAAQ,WACnCL,WAAW,WAAa7P,EAAM8P,IAAa,MAG/C+C,GAAU,IAKd/S,EAAMmR,OACNnR,EAAM/B,SAENe,EAAKgB,MAAQA,GACVhB,EAiBH,IAAI+U,IAAW,SAAWC,GAuCxB,QAASC,GAAWxG,GAAM,MAAOA,GAEjC,QAASyG,GAAUzG,EAAI0G,GAErB,MADKA,KAAIA,EAAKC,GACP,GAAI3E,QACThC,EAAG4G,OAAOpI,QAAQ,KAAMkI,EAAG,IAAIlI,QAAQ,KAAMkI,EAAG,IAAK1G,EAAG6G,OAASC,EAAS,IAI9E,QAASC,GAASC,GAChB,GAAIA,IAASC,EAAS,MAAOC,EAE7B,IAAI1H,GAAMwH,EAAK/N,MAAM,IAErB,IAAmB,IAAfuG,EAAIlM,QAAgB,+BAA+ByC,KAAKiR,GAC1D,KAAM,IAAIG,OAAM,yBAA2BH,EAAO,IASpD,OAPAxH,GAAMA,EAAImC,OAAOqF,EAAKxI,QAAQ,sBAAuB,MAAMvF,MAAM,MAEjEuG,EAAI,GAAKiH,EAASjH,EAAI,GAAGlM,OAAS,EAAI,aAAe4T,EAAO,GAAI1H,GAChEA,EAAI,GAAKiH,EAASO,EAAK1T,OAAS,EAAI,WAAa4T,EAAO,GAAI1H,GAC5DA,EAAI,GAAKiH,EAASS,EAAO,GAAI1H,GAC7BA,EAAI,GAAKwC,OAAO,QAAUxC,EAAI,GAAK,cAAgBA,EAAI,GAAK,KAAO4H,EAAWN,GAC9EtH,EAAI,GAAKwH,EACFxH,EAGT,QAAS6H,GAAWC,GAClB,MAAOA,aAAmBtF,QAASuF,EAAOD,GAAWX,EAAOW,GAsF9D,QAASE,GAAQR,IACVA,IAASA,EAAOC,MAAcN,EAAO,KACxCA,EAASI,EAAQC,GACjBO,EAASP,IAASC,EAAUT,EAAYC,EACxCE,EAAO,GAAKY,EAAOL,EAAO,IAC1BP,EAAO,IAAMY,EAAOL,EAAO,MAE7BO,EAAiBT,EAGnB,QAASU,GAAc7H,GACrB,GAAI8H,EACJ9H,GAAIA,MACJ8H,EAAI9H,EAAEyG,SACN3S,OAAOiE,eAAeiI,EAAG,YACvB+H,IAAKJ,EACLK,IAAK,WAAc,MAAOJ,IAC1BvI,YAAY,IAEd4I,EAAYjI,EACZ2H,EAAOG,GA3KT,GAiCEJ,GAEAO,EAlCAhB,EAAS,IAETiB,EAAY,qCAEZC,EAAY,+DAEZZ,EAAYY,EAAUpB,OAAS,IAC7B,wDAAwDA,OAAS,IACjE,8EAA8EA,OAEhFqB,GACEC,IAAKlG,OAAO,UAAcoF,EAAWN,GACrCqB,IAAKnG,OAAO,YAAcoF,EAAWN,GACrCsB,IAAKpG,OAAO,UAAcoF,EAAWN,IAGvCG,EAAU,MAERC,GACF,IAAK,IACL,IAAK,IACL,UACA,YACA,WACAlF,OAAO,uBAAyBoF,EAAWN,GAC3CG,EACA,yDACA,wBAIAQ,EAAiBlB,EAEjBI,IAyJF,OAvHAU,GAAUpO,MAAQ,SAAgB0H,EAAKhL,EAAM0S,GA0C3C,QAASC,GAAanF,GAChBxN,GAAQ4S,EACVC,EAAM3T,KAAKsO,GAAKA,EAAE3E,QAAQ6J,EAAI,GAAI,OAElCG,EAAM3T,KAAKsO,GAGf,QAASsF,GAAYtF,EAAGuF,EAAIC,GAC1B,GACEzG,GACA0G,EAAQX,EAAWS,EAIrB,KAFAE,EAAMC,UAAYF,EAClBA,EAAK,GACEzG,EAAQ0G,EAAM3I,KAAKkD,OACpBjB,EAAM,KACNA,EAAM,KAAOwG,IAAOC,IAAOA,MAEjC,MAAOA,GAAKxF,EAAE7P,OAASsV,EAAMC,UA1D1BR,IAAKA,EAAM1B,EAEhB,IAEEzE,GACAqG,EACA9V,EACAO,EAJAwV,KAKAxI,EAAKqI,EAAI,EAIX,KAFAE,EAAS9V,EAAQuN,EAAG6I,UAAY,EAEzB3G,EAAQlC,EAAGC,KAAKU,IAAM,CAI3B,GAFA3N,EAAMkP,EAAM4G,MAERP,EAAQ,CAEV,GAAIrG,EAAM,GAAI,CACZlC,EAAG6I,UAAYJ,EAAW9H,EAAKuB,EAAM,GAAIlC,EAAG6I,UAC5C,UAEF,IAAK3G,EAAM,GACT,SAGCA,EAAM,KACToG,EAAY3H,EAAI9I,MAAMpF,EAAOO,IAC7BP,EAAQuN,EAAG6I,UACX7I,EAAKqI,EAAI,GAAKE,GAAU,IACxBvI,EAAG6I,UAAYpW,GAQnB,MAJIkO,IAAOlO,EAAQkO,EAAIrN,QACrBgV,EAAY3H,EAAI9I,MAAMpF,IAGjB+V,GAwBTnB,EAAU5O,QAAU,SAAkBkI,GACpC,MAAOgG,GAAO,GAAG5Q,KAAK4K,IAGxB0G,EAAU7Q,SAAW,SAAmB5D,GACtC,GAAImN,GAAInN,EAAKsP,MAAMyE,EAAO,GAC1B,OAAO5G,IACDlN,IAAKkN,EAAE,GAAI/M,IAAK+M,EAAE,GAAIjN,IAAK6T,EAAO,GAAK5G,EAAE,GAAGgJ,OAASpC,EAAO,KAC5D7T,IAAKF,EAAKmW,SAGlB1B,EAAU2B,OAAS,SAAU5U,GAC3B,MAAOuS,GAAO,IAAI5Q,KAAK3B,IAGzBiT,EAAU4B,MAAQ,SAAgBjC,GAChC,MAAOA,GAAOD,EAAQC,GAAQL,GA0BhChT,OAAOiE,eAAeyP,EAAW,YAC/BO,IAAKF,EACLG,IAAK,WAAc,MAAOC,MAI5BT,EAAUtG,SAA2B,mBAATxP,IAAwBA,EAAKwP,aACzDsG,EAAUO,IAAMJ,EAEhBH,EAAUW,UAAYA,EACtBX,EAAUU,UAAYA,EACtBV,EAAUD,UAAYA,EAEfC,KAYL1R,GAAO,WAIT,QAASuT,GAAOvI,EAAKxO,GACnB,MAAKwO,IAEGgG,EAAOhG,KAASgG,EAAOhG,GAAOoG,EAAQpG,KAAOhF,KAAKxJ,EAAMgX,GAF/CxI,EAanB,QAASwI,GAASC,EAAK/P,GAEjB6P,EAAMG,eAERD,EAAIE,UACFxV,QAASuF,GAAOA,EAAIrD,MAAQqD,EAAIrD,KAAKlC,QACrCwI,SAAUjD,GAAOA,EAAIiD,UAEvB4M,EAAMG,aAAaD,IAIvB,QAASrC,GAASpG,GAEhB,GAAI/N,GAAO2W,EAAS5I,EAGpB,OAF0B,gBAAtB/N,EAAKiF,MAAM,EAAG,MAAuBjF,EAAO,UAAYA,GAErD,GAAI4W,UAAS,IAAK5W,EAAO,KAOlC,QAAS2W,GAAU5I,GACjB,GAEE/N,GADA6W,KAEAjB,EAAQlC,GAASrN,MAAM0H,EAAInC,QAAQ,UAAW,KAAM,EAEtD,IAAIgK,EAAMlV,OAAS,GAAKkV,EAAM,GAAI,CAChC,GAAInV,GAAGE,EAAGmW,IAEV,KAAKrW,EAAIE,EAAI,EAAGF,EAAImV,EAAMlV,SAAUD,EAElCT,EAAO4V,EAAMnV,GAETT,IAASA,EAAW,EAAJS,EAEdsW,EAAW/W,EAAM,EAAG6W,GAEpB,IAAM7W,EACH4L,QAAQ,MAAO,QACfA,QAAQ,YAAa,OACrBA,QAAQ,KAAM,OACjB,OAEDkL,EAAKnW,KAAOX,EAInBA,GAAW,EAAJW,EAAQmW,EAAK,GACb,IAAMA,EAAKE,KAAK,KAAO,iBAI9BhX,GAAO+W,EAAWnB,EAAM,GAAI,EAAGiB,EAUjC,OAPIA,GAAK,KACP7W,EAAOA,EAAK4L,QAAQqL,EAAW,SAAUpL,EAAGzL,GAC1C,MAAOyW,GAAKzW,GACTwL,QAAQ,MAAO,OACfA,QAAQ,MAAO,UAGf5L,EAWT,QAAS+W,GAAY/W,EAAMkX,EAAQL,GA0CjC,QAAShB,GAAYC,EAAI1I,GACvB,GACE+J,GACAC,EAAK,EACLC,EAAKC,EAASxB,EAGhB,KADAuB,EAAGpB,UAAY7I,EAAG6I,UACXkB,EAAKE,EAAGhK,KAAKrN,IAClB,GAAImX,EAAG,KAAOrB,IAAMsB,MACf,OAAOA,EAAI,KAElBhK,GAAG6I,UAAYmB,EAAKpX,EAAKU,OAAS2W,EAAGpB,UA1CvC,GATgB,MAAZjW,EAAK,KAAYA,EAAOA,EAAKiF,MAAM,IAEvCjF,EAAOA,EACA4L,QAAQ2L,EAAW,SAAUhH,EAAGiH,GAC/B,MAAOjH,GAAE7P,OAAS,IAAM8W,EAAM,KAAUX,EAAK5U,KAAKsO,GAAK,GAAK,IAAMA,IAEnE3E,QAAQ,OAAQ,KAAKuK,OACrBvK,QAAQ,wBAAyB,MAE9B,CAMR,IALA,GAGE0D,GAFAwH,KACAW,EAAM,EAGDzX,IACAsP,EAAQtP,EAAKsP,MAAMoI,MACnBpI,EAAM4G,OACT,CACF,GACEjW,GACA0X,EACAvK,EAAK,cAKP,KAHApN,EAAOoP,OAAOwI,aACd3X,EAAOqP,EAAM,GAAKuH,EAAKvH,EAAM,IAAIrK,MAAM,EAAG,IAAIkR,OAAOvK,QAAQ,OAAQ,KAAO0D,EAAM,GAE3EqI,GAAOrI,EAAQlC,EAAGC,KAAKrN,IAAO,IAAI6V,EAAW8B,EAAKvK,EAEzDuK,GAAO3X,EAAKiF,MAAM,EAAGqK,EAAM4G,OAC3BlW,EAAOoP,OAAOwI,aAEdd,EAAKW,KAASI,EAAUF,EAAK,EAAG1X,GAGlCD,EAAQyX,EACJA,EAAM,EAAI,IAAMX,EAAKE,KAAK,KAAO,qBAAuBF,EAAK,GADnDe,EAAU7X,EAAMkX,GAGhC,MAAOlX,GAuBT,QAAS6X,GAAW7X,EAAMkX,EAAQjX,GAChC,GAAI6X,EAiCJ,OA/BA9X,GAAOA,EAAK4L,QAAQmM,EAAY,SAAUzI,EAAOhG,EAAG0O,EAAM5X,EAAKmQ,GAW7D,MAVIyH,KACF5X,EAAM0X,EAAK,EAAI1X,EAAMkP,EAAM5O,OAEd,SAATsX,GAA4B,WAATA,GAA8B,WAATA,GAC1C1I,EAAQhG,EAAI,KAAO0O,EAAOC,EAAaD,EACnC5X,IAAK0X,EAAsB,OAAhBvH,EAAIA,EAAEnQ,KAAuB,MAANmQ,GAAmB,MAANA,IAC1CnQ,IACT0X,GAAMI,EAAW/U,KAAKoN,EAAEtL,MAAM7E,MAG3BkP,IAGLwI,IACF9X,EAAO,cAAgBA,EAAO,wBAG5BC,EAEFD,GAAQ8X,EACJ,cAAgB9X,EAAO,eAAiB,IAAMA,EAAO,KACnD,KAAOC,EAAM,OAEViX,IAETlX,EAAO,gBAAkB8X,EACrB9X,EAAK4L,QAAQ,UAAW,MAAQ,MAAQ5L,EAAO,KAC7C,qCAGDA,EA9LT,GAAI+T,KAQJuC,GAAM6B,QAAUzE,GAAS0C,OAEzBE,EAAMzQ,QAAU6N,GAAS7N,QAEzByQ,EAAM1S,SAAW8P,GAAS9P,SAE1B0S,EAAMG,aAAe,IAsBrB,IACEc,GAAYnI,OAAOsE,GAASc,UAAW,KACvCyC,EAAY,cAgDZK,GACEhC,IAAK,QACLC,IAAK,SACLC,IAAK,SAEPkC,EAAW,yDA6DXO,EAAa,kBAAsC,gBAAXla,GAAsB,SAAW,UAAY,KACrFga,EAAa,8JACbG,EAAa,+BA4Cf,OAJA5B,GAAM8B,MAAQ,SAAU7H,GAAK,MAAOA,IAEpC+F,EAAMpI,QAAUwF,GAASxF,QAAU,UAE5BoI,KAWLtO,GAAQ,SAAWqQ,GAuBrB,QAASC,GAAOzV,EAAMqK,EAAMnH,GAE1B,GAAIwS,GAAQ1V,EAAKE,KACfuM,EAAUiJ,GAASA,EAAMjJ,MAAM,iBAC/BpO,EAAUoO,GAASA,EAAM,GAAG3H,cAC5BhG,EAAK2L,EAAK,MAiBZ,OAfKJ,KAAMA,EAAO,IAEdrK,EAAKoF,QAAOlC,EAAKkC,MAAQuQ,EAAa3V,EAAKoF,MAAOiF,IAGtDqL,EAAQC,EAAaD,EAAOrL,GAGxBuL,EAAQtV,KAAKjC,GACfS,EAAK+W,EAAY/W,EAAI4W,EAAOrX,GAE5BS,EAAGgD,UAAY4T,EAEjB5W,EAAGoC,MAAO,EAEHpC,EAOT,QAAS+W,GAAY/W,EAAI4W,EAAOrX,GAC9B,GACEyX,GAAwB,MAAfzX,EAAQ,GACjBoB,EAASqW,EAAS,UAAY,QAShC,IALAhX,EAAGgD,UAAY,IAAMrC,EAASiW,EAAMpC,OAAS,KAAO7T,EACpDA,EAASX,EAAGiD,WAIR+T,EACFrW,EAAOsW,cAAgB,OAClB,CACL,GAAIC,GAAQC,EAAQ5X,EAChB2X,IAAsC,IAA7BvW,EAAOwC,WAAWpE,SAAc4B,EAASoL,EAAEmL,EAAOvW,IAEjE,MAAOA,GAOT,QAASkW,GAAaD,EAAOrL,GAE3B,IAAK6L,EAAW5V,KAAKoV,GAAQ,MAAOA,EAGpC,IAAIS,GAAI,CAeR,OAdAT,GAAQA,EAAM3M,QAAQqN,EAAa,SAAUpN,EAAGvI,EAAK4V,GACnD,GAAI/L,GAAID,EAAKoC,MAAMF,OAAO+J,EAAWvN,QAAQ,IAAKtI,GAAM,KAExD,OADA0V,GAAI,GACI7L,EAAIA,EAAE,GAAK+L,IAAQ,MAIzBF,GAAKD,EAAW5V,KAAKoV,MACnBrL,IAAMA,EAAOA,EAAKtB,QAAQwN,EAAY,IAAIjD,QAC9CoC,EAAQA,EAAM3M,QAAQyN,EAAY,SAAUxN,EAAGqN,GAC7C,MAAOhM,IAAQgM,GAAO,MAInBX,EAhGT,GACEQ,GAAc,YACdM,EAAc,6CACdD,EAAc,8CACdH,EAAc,uEACdE,EAAc,wDACdL,GAAYQ,GAAI,QAASC,GAAI,KAAMC,GAAI,KAAMC,IAAK,WAEpDpB,GAAUA,GAAqB,GAAVA,CACrB,IAAII,GAAUJ,EACVnV,GAAqB,uDAyFzB,OAAOoV,IAENzN,IA0PC6O,GAAe,SAAUC,GAE3B,IAAK5b,EAAQ,OACX+M,IAAK,aACL8O,OAAQ,aAGV,IAAIC,GAAY,WAEd,GAAIC,GAAUxM,EAAK,QACnBpE,GAAQ4Q,EAAS,OAAQ,WAGzB,IAAIC,GAAWrM,EAAE,mBAOjB,OANIqM,IACEA,EAAS1a,KAAIya,EAAQza,GAAK0a,EAAS1a,IACvC0a,EAAS1W,WAAW2W,aAAaF,EAASC,IAEvClc,SAASoc,qBAAqB,QAAQ,GAAGjY,YAAY8X,GAEnDA,KAILI,EAAcL,EAAUM,WAC1BC,EAAiB,EAWnB,OARArZ,QAAOiE,eAAe2U,EAAO,aAC3BrT,MAAOuT,EACPtN,UAAU,KAWVzB,IAAK,SAASuP,GACZD,GAAkBC,GAMpBT,OAAQ,WACFQ,IACEF,EAAaA,EAAYI,SAAWF,EACnCP,EAAUlV,WAAayV,EAC5BA,EAAiB,OAKtBzb,GA46BCyJ,GAAM,SAAWmS,GACnB,GAAIC,GAAMD,EAAEE,uBACFF,EAAEG,0BAA4BH,EAAEI,2BAE1C,KAAKH,GAAO,uBAAuBrX,KAAKoX,EAAEK,UAAUC,WAAY,CAC9D,GAAIC,GAAW,CAEfN,GAAM,SAAU9L,GACd,GAAIqM,GAAU3c,KAAKC,MAAO2c,EAAUC,KAAKC,IAAI,IAAMH,EAAUD,GAAW,EACxEpL,YAAW,WAAchB,EAAGoM,EAAWC,EAAUC,IAAYA,IAGjE,MAAOR,IAENzc,MAgCHY,GAAKwc,MAASzH,SAAUA,GAAU3Q,KAAMA,IAKxCpE,EAAK6J,MAAQ,WACX,GAAI4S,KAQJ,OAAO,UAASjV,EAAMqC,GACpB,MAAIN,GAAS/B,IACXqC,EAAQrC,OACRiV,EAAOtS,GAAgBhD,EAAOsV,EAAOtS,OAAqBN,KAIvDA,OACL4S,EAAOjV,GAAQqC,GADI4S,EAAOjV,OAe9BxH,EAAKwC,IAAM,SAASgF,EAAM+G,EAAMmN,EAAKpS,EAAOP,GAa1C,MAZIe,GAAWR,KACbP,EAAKO,EACD,eAAe9E,KAAKkX,IACtBpS,EAAQoS,EACRA,EAAM,IACDpS,EAAQ,IAEboS,IACE5R,EAAW4R,GAAM3S,EAAK2S,EACrBX,GAAa5O,IAAIuP,IAExBvX,EAAUqD,IAAUA,KAAMA,EAAMpD,KAAMmK,EAAMjF,MAAOA,EAAOP,GAAIA,GACvDvB,GAaTxH,EAAKG,KAAO,SAASqH,EAAM+G,EAAMmN,EAAKpS,EAAOP,EAAI2T,GAI/C,MAHIhB,IAAKX,GAAa5O,IAAIuP,GAE1BvX,EAAUqD,IAAUA,KAAMA,EAAMpD,KAAMmK,EAAMjF,MAAOA,EAAOP,GAAIA,GACvDvB,GAUTxH,EAAKhB,MAAQ,SAAS6P,EAAUtM,EAASnC,GAQvC,QAASuc,GAAY1O,GACnB,GAAIkK,GAAO,EAKX,OAJAzV,GAAKuL,EAAK,SAAU9C,GACb,SAAS3G,KAAK2G,KACjBgN,GAAQ,MAAQvL,EAAW,IAAMzB,EAAEqM,OAAS,OAEzCW,EAGT,QAASyE,KACP,GAAIva,GAAOD,OAAOC,KAAK8B,EACvB,OAAO9B,GAAOsa,EAAYta,GAG5B,QAASwa,GAASpY,GAChB,GAAIA,EAAKlC,QAAS,CAChB,GAAIua,GAAU/Y,EAAQU,EAAMmI,EAGxBrK,IAAWua,IAAYva,IACzBua,EAAUva,EACVgI,EAAQ9F,EAAMmI,EAAUrK,GAE1B,IAAIC,GAAM6M,EAAQ5K,EAAMqY,GAAWrY,EAAKlC,QAAQyG,cAAe5I,EAE3DoC,IAAKZ,EAAK0B,KAAKd,OACViC,GAAK1C,QACdW,EAAK+B,EAAMoY,GAjCf,GAAIhQ,GACFkQ,EACAnb,IAgEF,IA1BAmZ,GAAaE,SAET1R,EAAShH,KACXnC,EAAOmC,EACPA,EAAU,SAIDsM,KAAa7K,GACL,MAAb6K,EAGFA,EAAWkO,EAAUH,IAGrB/N,GAAY8N,EAAY9N,EAASnH,MAAM,QAIzCmF,EAAMgC,EAAWD,EAAGC,OAIpBhC,EAAMgC,EAGQ,MAAZtM,EAAiB,CAInB,GAFAA,EAAUwa,GAAWH,IAEjB/P,EAAItK,QACNsK,EAAM+B,EAAGrM,EAASsK,OACf,CAEH,GAAImQ,KACJta,GAAKmK,EAAK,SAAUoQ,GAClBD,EAAS1Z,KAAKsL,EAAGrM,EAAS0a,MAE5BpQ,EAAMmQ,EAGRza,EAAU,EAKZ,MAFAsa,GAAShQ,GAEFjL,GAOT5B,EAAKkG,OAAS,WACZ,MAAOxD,GAAKmI,EAAc,SAASrI,GACjCA,EAAI0D,YAORlG,EAAK4F,IAAMA,QAGE1F,WAAYuM,EACrBxM,OAAOC,QAAUF,QACHkd,UAAWpQ,UAAqBoQ,QAAOC,MAAQlV,EAC7DiV,OAAO,WAAa,MAAOld,KAE3BZ,EAAOY,KAAOA,GAEE,mBAAVZ,QAAwBA,OAAS;;ADp9E3C,GAAIY,MAAOjB,QAAQ,OACnBkB,QAAOC,QAAUF,KAAKG,KAAK,MAAO,iYAAkY,GAAI,GAAI,SAASC,GACnbrB,QAAQ,0BACRA,QAAQ,0BACRA,QAAQ,yBACR,IAAIsB,GAAOC,IACXD,GAAKE,YAAc,KAEnBD,KAAKE,SAAW,SAASC,EAAUC,GAC7BL,EAAKE,aACPF,EAAKE,YAAYI,SAAQ,GAE3BN,EAAKE,YAAcP,KAAKhB,MAAM,aAAcyB,GAAWG,KAAMF,IAAK,IAClEG,KAAKP,MAEPA,KAAKQ,WAAa,SAASC,EAAML,GAC/B,OAAOK,GACP,IAAK,OACHV,EAAKG,SAAS,YAAaE,EAC3B,MACF,KAAK,OACHL,EAAKG,SAAS,YAAaE,EAC3B,MACF,KAAK,OACHL,EAAKG,SAAS,YAAaE,EAC3B,MACF,SACEV,KAAKgB,MAAM,YAEbH,KAAKP,MAEPN,KAAKgB,MAAMX,EAAKS,YAChBR,KAAKW,GAAG,QAAS,WACfjB,KAAKgB,MAAME,OAAM;;AOjCrB,GAAIlB,MAAOjB,QAAQ,OACnBkB,QAAOC,QAAUF,KAAKG,KAAK,UAAW,wZAAyZ,GAAI,GAAI,SAASC,GAC9c,GAAIgd,GAAQre,QAAQ,YAChBsB,EAAOC,IACXD,GAAKO,KAAOR,EAAKQ,KACjBP,EAAK6e,MAAO,EACZ7e,EAAK8e,eAAenZ,UAAY3F,EAAKO,KAAKwe,KAE1ChC,EAAMK,WAAWpd,EAAKO,KAAK8c,KAAM,SAAS2B,GACxChf,EAAKsd,SAAW0B,EAChBhf,EAAK6F,WAGP5F,KAAKmI,OAAS,SAAS0C,GACrB7K,KAAK4e,MAAQ5e,KAAK4e,MAClBre,KAAKP,OACN;;ADhBH,GAAIN,MAAOjB,QAAQ,OACnBkB,QAAOC,QAAUF,KAAKG,KAAK,OAAQ,wfAAyf,GAAI,GAAI,SAASC,GAC3iB,GAAIC,GAAOC,IACXD,GAAK0e,SAAW3e,EAAKQ,KAErBN,KAAKR,KAAO,WACV,MAAOO,GAAK0e,SAASlf,KAAQ,UAAYQ,EAAK0e,SAASre,IACvDG,KAAKP,MAEPA,KAAK0e,SAAW,WACd,MAA8B,UAAvB3e,EAAK0e,SAAS1X,MAA2C,SAAvBhH,EAAK0e,SAAS1X,MACvDxG,KAAKP,MAEPA,KAAK2e,WAAa,WAChB,MAA8B,UAAvB5e,EAAK0e,SAAS1X,MACrBxG,KAAKP,OACN;;APhBH,GAAIrB,QAASC,SAASC,cAAc,IAEpCC,QAAOC,SACLC,QAAS,SAAUC,GACjB,GAAIC,GAAUC,KAAKC,MAAQ,IAAOC,OAAOJ,EACzC,OAAc,MAAVC,KACQA,EAAU,IAAM,WACP,MAAVA,KACCA,EAAU,MAAQ,YAElBA,EAAU,OAAS,SAGjCI,OAAQ,SAAUC,GAEhB,MADAZ,QAAOa,KAAOD,EACPZ,OAAOc;;ADflBhB,QAAQ,gBACRA,QAAQ,cACRA,QAAQ,QAAQC,MAAM;;AOFtB,GAAIof,KAAM,GAAIC,UAAS,yCACnBC,eAAiB,GACjBC,kBACAC,QAAUzf,QAAQ,UAAU0f,aAC5BrB,MAAQ,GAAIoB,QAOhBJ,KAAIjc,MAAM,cAAclB,GAAG,QAAS,SAAUyd,GAC5CH,eAAiBG,EAASnd,MAC1B6b,MAAMlM,KAAK,YAUbkM,MAAMU,UAAY,SAAUpd,EAAIqP,GAC9BqO,IAAIjc,MAAM,QAAUzB,GAAIie,KAAK,QAAS,SAAUD,GAC9C3O,EAAG2O,EAASnd,UAWhB6b,MAAMC,UAAY,SAAU3c,EAAIqP,GAC9BqO,IAAIjc,MAAM,QAAUzB,GAAIie,KAAK,QAAS,SAAUD,GAC9C3O,EAAG2O,EAASnd,UAWhB6b,MAAMK,WAAa,SAAUmB,EAAK7O,GAMhC,QAAS8O,GAASrd,GAChBG,EAAM2B,KAAK9B,GACPG,EAAMI,QAAU6c,EAAI7c,QACtBgO,EAAGpO,GARP,IAAKid,IAAQA,EAAI7c,OAAQ,MAAOgO,MAChC,IAAIpO,KACJid,GAAItc,QAAQ,SAAU5B,GACpB0c,MAAMU,UAAUpd,EAAIme,MAiBxBzB,MAAMa,iBAAmB,SAAUF,EAAMhO,GACvC,GAAI7O,IAAS6c,EAAO,GAAKO,eACrBQ,EAAMf,EAAOO,eACbM,EAAML,eAAejY,MAAMpF,EAAO4d,EACtC1B,OAAMK,WAAWmB,EAAK7O,IAGxB9P,OAAOC,QAAUkd;;AF7EjB,GAAIpd,MAAOjB,QAAQ,OACnBkB,QAAOC,QAAUF,KAAKG,KAAK,YAAa,+YAAgZ,GAAI,GAAI,SAASC,GACvcrB,QAAQ,2BACRA,QAAQ,6BACR,IAAIqe,GAAQre,QAAQ,YAChBsB,EAAOC,IACXD,GAAKsB,SAELrB,KAAKkd,cAAgB,WACnBJ,EAAMK,WAAWpd,EAAKsB,MAAM,GAAG+b,KAAM,SAAUC,GAC7Ctd,EAAKsd,SAAWA,EAChBtd,EAAK6F,YAEPrF,KAAKP,MAEPA,KAAKsd,iBAAmB,WACtBR,EAAMK,WAAWpd,EAAKsB,MAAM,GAAGsV,MAAO,SAAUvJ,GAC9CrN,EAAKwd,YAAcnQ,EACnBrN,EAAK6F,YAEPrF,KAAKP,MAEP8c,EAAMU,UAAU1d,EAAKQ,KAAM,SAAUY,GACnCnB,EAAKsB,OAAUH,GACfnB,EAAKmd,gBACa,SAAdhc,EAAK6F,MACPhH,EAAKud,mBAEPvd,EAAK6F,YAEN;;AC9BH,GAAIlG,MAAOjB,QAAQ,OACnBkB,QAAOC,QAAUF,KAAKG,KAAK,YAAa,uXAAwX,GAAI,GAAI,SAASC,GAC/arB,QAAQ,0BACR,IAAIqe,GAAQre,QAAQ,YAChBsB,EAAOC,IACXD,GAAK0d,KAAO3d,EAAKQ,KACjBP,EAAKsB,SAELrB,KAAK0d,UAAY,WACfZ,EAAMa,iBAAiB5d,EAAK0d,KAAM,SAAUpc,GAC1CtB,EAAKsB,MAAQA,EACbtB,EAAK6d,YAAc7d,EAAK0d,KACxB1d,EAAK6F,YAEPrF,KAAKP,MAEPD,EAAKY,GAAG,QAAS,WACfZ,EAAK2d,YACLZ,EAAMnc,GAAG,SAAUZ,EAAK2d,aAG1B3d,EAAKY,GAAG,UAAW,WACjBmc,EAAMe,eAAe,SAAU9d,EAAK2d,cAErC;;AFxBH,GAAIhe,MAAOjB,QAAQ,OACnBkB,QAAOC,QAAUF,KAAKG,KAAK,YAAa,kgBAAmgB,GAAI,GAAI,SAASC,GAC1jB,GAAIgd,GAAQre,QAAQ,YAChBsB,EAAOC,IACXD,GAAKY,GAAG,QAAS,WACfmc,EAAMC,UAAUjd,EAAKQ,KAAM,SAAU0c,GACnCjd,EAAKid,KAAOA,EACZjd,EAAKkd,MAAMvX,UAAY3F,EAAKid,KAAKC,MACjCld,EAAK6F,cAGR","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","require('./filters.js')\nrequire('./app.html')\nrequire('riot').mount('app')\n","var parser = document.createElement('a')\n\nwindow.filters = {\n  fromNow: function (time) {\n    var between = Date.now() / 1000 - Number(time)\n    if (between < 3600) {\n      return ~~(between / 60) + ' minutes'\n    } else if (between < 86400) {\n      return ~~(between / 3600) + ' hours'\n    } else {\n      return ~~(between / 86400) + ' days'\n    }\n  },\n  domain: function (url) {\n    parser.href = url\n    return parser.hostname\n  }\n}\n","var riot = require('riot');\nmodule.exports = riot.tag2('app', '<div id=\"wrapper\"> <div id=\"header\"> <a id=\"yc\" href=\"http://www.ycombinator.com\"> <img src=\"https://news.ycombinator.com/y18.gif\"> </a> <h1><a href=\"#\">Hacker News</a></h1> <span class=\"source\"> Built with <a href=\"http://riotjs.com/\" target=\"_blank\">Riot.js</a> | <a href=\"https://github.com/txchen/riot-hn\" target=\"_blank\">Source</a> </span> </div> <div id=\"hnview\"></div> </div>', '', '', function(opts) {\n  require('./views/user-view.html')\n  require('./views/item-view.html')\n  require('./views/news-view.html')\n  var self = this\n  self.currentView = null\n\n  this.loadView = function(viewName, id) {\n    if (self.currentView) {\n      self.currentView.unmount(true)\n    }\n    self.currentView = riot.mount('div#hnview', viewName, {data: id})[0]\n  }.bind(this)\n\n  this.studyRoute = function(view, id) {\n    switch(view) {\n    case 'user':\n      self.loadView('user-view', id)\n      break\n    case 'item':\n      self.loadView('item-view', id)\n      break\n    case 'news':\n      self.loadView('news-view', id)\n      break\n    default:\n      riot.route('news/1')\n    }\n  }.bind(this)\n\n  riot.route(self.studyRoute)\n  this.on('mount', function() {\n    riot.route.start(true)\n  })\n});\n","/* Riot v2.3.16, @license MIT */\n\n;(function(window, undefined) {\n  'use strict';\nvar riot = { version: 'v2.3.16', settings: {} },\n  // be aware, internal usage\n  // ATTENTION: prefix the global dynamic variables with `__`\n\n  // counter to give a unique id to all the Tag instances\n  __uid = 0,\n  // tags instances cache\n  __virtualDom = [],\n  // tags implementation cache\n  __tagImpl = {},\n\n  /**\n   * Const\n   */\n  GLOBAL_MIXIN = '__global_mixin',\n\n  // riot specific prefixes\n  RIOT_PREFIX = 'riot-',\n  RIOT_TAG = RIOT_PREFIX + 'tag',\n\n  // for typeof == '' comparisons\n  T_STRING = 'string',\n  T_OBJECT = 'object',\n  T_UNDEF  = 'undefined',\n  T_FUNCTION = 'function',\n  // special native tags that cannot be treated like the others\n  SPECIAL_TAGS_REGEX = /^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?|opt(?:ion|group))$/,\n  RESERVED_WORDS_BLACKLIST = ['_item', '_id', '_parent', 'update', 'root', 'mount', 'unmount', 'mixin', 'isMounted', 'isLoop', 'tags', 'parent', 'opts', 'trigger', 'on', 'off', 'one'],\n\n  // version# for IE 8-11, 0 for others\n  IE_VERSION = (window && window.document || {}).documentMode | 0\n/* istanbul ignore next */\nriot.observable = function(el) {\n\n  /**\n   * Extend the original object or create a new empty one\n   * @type { Object }\n   */\n\n  el = el || {}\n\n  /**\n   * Private variables and methods\n   */\n  var callbacks = {},\n    slice = Array.prototype.slice,\n    onEachEvent = function(e, fn) { e.replace(/\\S+/g, fn) }\n\n  // extend the object adding the observable methods\n  Object.defineProperties(el, {\n    /**\n     * Listen to the given space separated list of `events` and execute the `callback` each time an event is triggered.\n     * @param  { String } events - events ids\n     * @param  { Function } fn - callback function\n     * @returns { Object } el\n     */\n    on: {\n      value: function(events, fn) {\n        if (typeof fn != 'function')  return el\n\n        onEachEvent(events, function(name, pos) {\n          (callbacks[name] = callbacks[name] || []).push(fn)\n          fn.typed = pos > 0\n        })\n\n        return el\n      },\n      enumerable: false,\n      writable: false,\n      configurable: false\n    },\n\n    /**\n     * Removes the given space separated list of `events` listeners\n     * @param   { String } events - events ids\n     * @param   { Function } fn - callback function\n     * @returns { Object } el\n     */\n    off: {\n      value: function(events, fn) {\n        if (events == '*' && !fn) callbacks = {}\n        else {\n          onEachEvent(events, function(name) {\n            if (fn) {\n              var arr = callbacks[name]\n              for (var i = 0, cb; cb = arr && arr[i]; ++i) {\n                if (cb == fn) arr.splice(i--, 1)\n              }\n            } else delete callbacks[name]\n          })\n        }\n        return el\n      },\n      enumerable: false,\n      writable: false,\n      configurable: false\n    },\n\n    /**\n     * Listen to the given space separated list of `events` and execute the `callback` at most once\n     * @param   { String } events - events ids\n     * @param   { Function } fn - callback function\n     * @returns { Object } el\n     */\n    one: {\n      value: function(events, fn) {\n        function on() {\n          el.off(events, on)\n          fn.apply(el, arguments)\n        }\n        return el.on(events, on)\n      },\n      enumerable: false,\n      writable: false,\n      configurable: false\n    },\n\n    /**\n     * Execute all callback functions that listen to the given space separated list of `events`\n     * @param   { String } events - events ids\n     * @returns { Object } el\n     */\n    trigger: {\n      value: function(events) {\n\n        // getting the arguments\n        var arglen = arguments.length - 1,\n          args = new Array(arglen),\n          fns\n\n        for (var i = 0; i < arglen; i++) {\n          args[i] = arguments[i + 1] // skip first argument\n        }\n\n        onEachEvent(events, function(name) {\n\n          fns = slice.call(callbacks[name] || [], 0)\n\n          for (var i = 0, fn; fn = fns[i]; ++i) {\n            if (fn.busy) return\n            fn.busy = 1\n            fn.apply(el, fn.typed ? [name].concat(args) : args)\n            if (fns[i] !== fn) { i-- }\n            fn.busy = 0\n          }\n\n          if (callbacks['*'] && name != '*')\n            el.trigger.apply(el, ['*', name].concat(args))\n\n        })\n\n        return el\n      },\n      enumerable: false,\n      writable: false,\n      configurable: false\n    }\n  })\n\n  return el\n\n}\n/* istanbul ignore next */\n;(function(riot) {\n\n/**\n * Simple client-side router\n * @module riot-route\n */\n\n\nvar RE_ORIGIN = /^.+?\\/+[^\\/]+/,\n  EVENT_LISTENER = 'EventListener',\n  REMOVE_EVENT_LISTENER = 'remove' + EVENT_LISTENER,\n  ADD_EVENT_LISTENER = 'add' + EVENT_LISTENER,\n  HAS_ATTRIBUTE = 'hasAttribute',\n  REPLACE = 'replace',\n  POPSTATE = 'popstate',\n  HASHCHANGE = 'hashchange',\n  TRIGGER = 'trigger',\n  MAX_EMIT_STACK_LEVEL = 3,\n  win = typeof window != 'undefined' && window,\n  doc = typeof document != 'undefined' && document,\n  hist = win && history,\n  loc = win && (hist.location || win.location), // see html5-history-api\n  prot = Router.prototype, // to minify more\n  clickEvent = doc && doc.ontouchstart ? 'touchstart' : 'click',\n  started = false,\n  central = riot.observable(),\n  routeFound = false,\n  debouncedEmit,\n  base, current, parser, secondParser, emitStack = [], emitStackLevel = 0\n\n/**\n * Default parser. You can replace it via router.parser method.\n * @param {string} path - current path (normalized)\n * @returns {array} array\n */\nfunction DEFAULT_PARSER(path) {\n  return path.split(/[/?#]/)\n}\n\n/**\n * Default parser (second). You can replace it via router.parser method.\n * @param {string} path - current path (normalized)\n * @param {string} filter - filter string (normalized)\n * @returns {array} array\n */\nfunction DEFAULT_SECOND_PARSER(path, filter) {\n  var re = new RegExp('^' + filter[REPLACE](/\\*/g, '([^/?#]+?)')[REPLACE](/\\.\\./, '.*') + '$'),\n    args = path.match(re)\n\n  if (args) return args.slice(1)\n}\n\n/**\n * Simple/cheap debounce implementation\n * @param   {function} fn - callback\n * @param   {number} delay - delay in seconds\n * @returns {function} debounced function\n */\nfunction debounce(fn, delay) {\n  var t\n  return function () {\n    clearTimeout(t)\n    t = setTimeout(fn, delay)\n  }\n}\n\n/**\n * Set the window listeners to trigger the routes\n * @param {boolean} autoExec - see route.start\n */\nfunction start(autoExec) {\n  debouncedEmit = debounce(emit, 1)\n  win[ADD_EVENT_LISTENER](POPSTATE, debouncedEmit)\n  win[ADD_EVENT_LISTENER](HASHCHANGE, debouncedEmit)\n  doc[ADD_EVENT_LISTENER](clickEvent, click)\n  if (autoExec) emit(true)\n}\n\n/**\n * Router class\n */\nfunction Router() {\n  this.$ = []\n  riot.observable(this) // make it observable\n  central.on('stop', this.s.bind(this))\n  central.on('emit', this.e.bind(this))\n}\n\nfunction normalize(path) {\n  return path[REPLACE](/^\\/|\\/$/, '')\n}\n\nfunction isString(str) {\n  return typeof str == 'string'\n}\n\n/**\n * Get the part after domain name\n * @param {string} href - fullpath\n * @returns {string} path from root\n */\nfunction getPathFromRoot(href) {\n  return (href || loc.href || '')[REPLACE](RE_ORIGIN, '')\n}\n\n/**\n * Get the part after base\n * @param {string} href - fullpath\n * @returns {string} path from base\n */\nfunction getPathFromBase(href) {\n  return base[0] == '#'\n    ? (href || loc.href || '').split(base)[1] || ''\n    : getPathFromRoot(href)[REPLACE](base, '')\n}\n\nfunction emit(force) {\n  // the stack is needed for redirections\n  var isRoot = emitStackLevel == 0\n  if (MAX_EMIT_STACK_LEVEL <= emitStackLevel) return\n\n  emitStackLevel++\n  emitStack.push(function() {\n    var path = getPathFromBase()\n    if (force || path != current) {\n      central[TRIGGER]('emit', path)\n      current = path\n    }\n  })\n  if (isRoot) {\n    while (emitStack.length) {\n      emitStack[0]()\n      emitStack.shift()\n    }\n    emitStackLevel = 0\n  }\n}\n\nfunction click(e) {\n  if (\n    e.which != 1 // not left click\n    || e.metaKey || e.ctrlKey || e.shiftKey // or meta keys\n    || e.defaultPrevented // or default prevented\n  ) return\n\n  var el = e.target\n  while (el && el.nodeName != 'A') el = el.parentNode\n  if (\n    !el || el.nodeName != 'A' // not A tag\n    || el[HAS_ATTRIBUTE]('download') // has download attr\n    || !el[HAS_ATTRIBUTE]('href') // has no href attr\n    || el.target && el.target != '_self' // another window or frame\n    || el.href.indexOf(loc.href.match(RE_ORIGIN)[0]) == -1 // cross origin\n  ) return\n\n  if (el.href != loc.href) {\n    if (\n      el.href.split('#')[0] == loc.href.split('#')[0] // internal jump\n      || base != '#' && getPathFromRoot(el.href).indexOf(base) !== 0 // outside of base\n      || !go(getPathFromBase(el.href), el.title || doc.title) // route not found\n    ) return\n  }\n\n  e.preventDefault()\n}\n\n/**\n * Go to the path\n * @param {string} path - destination path\n * @param {string} title - page title\n * @param {boolean} shouldReplace - use replaceState or pushState\n * @returns {boolean} - route not found flag\n */\nfunction go(path, title, shouldReplace) {\n  if (hist) { // if a browser\n    path = base + normalize(path)\n    title = title || doc.title\n    // browsers ignores the second parameter `title`\n    shouldReplace\n      ? hist.replaceState(null, title, path)\n      : hist.pushState(null, title, path)\n    // so we need to set it manually\n    doc.title = title\n    routeFound = false\n    emit()\n    return routeFound\n  }\n\n  // Server-side usage: directly execute handlers for the path\n  return central[TRIGGER]('emit', getPathFromBase(path))\n}\n\n/**\n * Go to path or set action\n * a single string:                go there\n * two strings:                    go there with setting a title\n * two strings and boolean:        replace history with setting a title\n * a single function:              set an action on the default route\n * a string/RegExp and a function: set an action on the route\n * @param {(string|function)} first - path / action / filter\n * @param {(string|RegExp|function)} second - title / action\n * @param {boolean} third - replace flag\n */\nprot.m = function(first, second, third) {\n  if (isString(first) && (!second || isString(second))) go(first, second, third || false)\n  else if (second) this.r(first, second)\n  else this.r('@', first)\n}\n\n/**\n * Stop routing\n */\nprot.s = function() {\n  this.off('*')\n  this.$ = []\n}\n\n/**\n * Emit\n * @param {string} path - path\n */\nprot.e = function(path) {\n  this.$.concat('@').some(function(filter) {\n    var args = (filter == '@' ? parser : secondParser)(normalize(path), normalize(filter))\n    if (typeof args != 'undefined') {\n      this[TRIGGER].apply(null, [filter].concat(args))\n      return routeFound = true // exit from loop\n    }\n  }, this)\n}\n\n/**\n * Register route\n * @param {string} filter - filter for matching to url\n * @param {function} action - action to register\n */\nprot.r = function(filter, action) {\n  if (filter != '@') {\n    filter = '/' + normalize(filter)\n    this.$.push(filter)\n  }\n  this.on(filter, action)\n}\n\nvar mainRouter = new Router()\nvar route = mainRouter.m.bind(mainRouter)\n\n/**\n * Create a sub router\n * @returns {function} the method of a new Router object\n */\nroute.create = function() {\n  var newSubRouter = new Router()\n  // stop only this sub-router\n  newSubRouter.m.stop = newSubRouter.s.bind(newSubRouter)\n  // return sub-router's main method\n  return newSubRouter.m.bind(newSubRouter)\n}\n\n/**\n * Set the base of url\n * @param {(str|RegExp)} arg - a new base or '#' or '#!'\n */\nroute.base = function(arg) {\n  base = arg || '#'\n  current = getPathFromBase() // recalculate current path\n}\n\n/** Exec routing right now **/\nroute.exec = function() {\n  emit(true)\n}\n\n/**\n * Replace the default router to yours\n * @param {function} fn - your parser function\n * @param {function} fn2 - your secondParser function\n */\nroute.parser = function(fn, fn2) {\n  if (!fn && !fn2) {\n    // reset parser for testing...\n    parser = DEFAULT_PARSER\n    secondParser = DEFAULT_SECOND_PARSER\n  }\n  if (fn) parser = fn\n  if (fn2) secondParser = fn2\n}\n\n/**\n * Helper function to get url query as an object\n * @returns {object} parsed query\n */\nroute.query = function() {\n  var q = {}\n  var href = loc.href || current\n  href[REPLACE](/[?&](.+?)=([^&]*)/g, function(_, k, v) { q[k] = v })\n  return q\n}\n\n/** Stop routing **/\nroute.stop = function () {\n  if (started) {\n    if (win) {\n      win[REMOVE_EVENT_LISTENER](POPSTATE, debouncedEmit)\n      win[REMOVE_EVENT_LISTENER](HASHCHANGE, debouncedEmit)\n      doc[REMOVE_EVENT_LISTENER](clickEvent, click)\n    }\n    central[TRIGGER]('stop')\n    started = false\n  }\n}\n\n/**\n * Start routing\n * @param {boolean} autoExec - automatically exec after starting if true\n */\nroute.start = function (autoExec) {\n  if (!started) {\n    if (win) {\n      if (document.readyState == 'complete') start(autoExec)\n      // the timeout is needed to solve\n      // a weird safari bug https://github.com/riot/route/issues/33\n      else win[ADD_EVENT_LISTENER]('load', function() {\n        setTimeout(function() { start(autoExec) }, 1)\n      })\n    }\n    started = true\n  }\n}\n\n/** Prepare the router **/\nroute.base()\nroute.parser()\n\nriot.route = route\n})(riot)\n/* istanbul ignore next */\n\n/**\n * The riot template engine\n * @version v2.3.21\n */\n\n/**\n * riot.util.brackets\n *\n * - `brackets    ` - Returns a string or regex based on its parameter\n * - `brackets.set` - Change the current riot brackets\n *\n * @module\n */\n\nvar brackets = (function (UNDEF) {\n\n  var\n    REGLOB = 'g',\n\n    R_MLCOMMS = /\\/\\*[^*]*\\*+(?:[^*\\/][^*]*\\*+)*\\//g,\n\n    R_STRINGS = /\"[^\"\\\\]*(?:\\\\[\\S\\s][^\"\\\\]*)*\"|'[^'\\\\]*(?:\\\\[\\S\\s][^'\\\\]*)*'/g,\n\n    S_QBLOCKS = R_STRINGS.source + '|' +\n      /(?:\\breturn\\s+|(?:[$\\w\\)\\]]|\\+\\+|--)\\s*(\\/)(?![*\\/]))/.source + '|' +\n      /\\/(?=[^*\\/])[^[\\/\\\\]*(?:(?:\\[(?:\\\\.|[^\\]\\\\]*)*\\]|\\\\.)[^[\\/\\\\]*)*?(\\/)[gim]*/.source,\n\n    FINDBRACES = {\n      '(': RegExp('([()])|'   + S_QBLOCKS, REGLOB),\n      '[': RegExp('([[\\\\]])|' + S_QBLOCKS, REGLOB),\n      '{': RegExp('([{}])|'   + S_QBLOCKS, REGLOB)\n    },\n\n    DEFAULT = '{ }'\n\n  var _pairs = [\n    '{', '}',\n    '{', '}',\n    /{[^}]*}/,\n    /\\\\([{}])/g,\n    /\\\\({)|{/g,\n    RegExp('\\\\\\\\(})|([[({])|(})|' + S_QBLOCKS, REGLOB),\n    DEFAULT,\n    /^\\s*{\\^?\\s*([$\\w]+)(?:\\s*,\\s*(\\S+))?\\s+in\\s+(\\S.*)\\s*}/,\n    /(^|[^\\\\]){=[\\S\\s]*?}/\n  ]\n\n  var\n    cachedBrackets = UNDEF,\n    _regex,\n    _cache = [],\n    _settings\n\n  function _loopback (re) { return re }\n\n  function _rewrite (re, bp) {\n    if (!bp) bp = _cache\n    return new RegExp(\n      re.source.replace(/{/g, bp[2]).replace(/}/g, bp[3]), re.global ? REGLOB : ''\n    )\n  }\n\n  function _create (pair) {\n    if (pair === DEFAULT) return _pairs\n\n    var arr = pair.split(' ')\n\n    if (arr.length !== 2 || /[\\x00-\\x1F<>a-zA-Z0-9'\",;\\\\]/.test(pair)) {\n      throw new Error('Unsupported brackets \"' + pair + '\"')\n    }\n    arr = arr.concat(pair.replace(/(?=[[\\]()*+?.^$|])/g, '\\\\').split(' '))\n\n    arr[4] = _rewrite(arr[1].length > 1 ? /{[\\S\\s]*?}/ : _pairs[4], arr)\n    arr[5] = _rewrite(pair.length > 3 ? /\\\\({|})/g : _pairs[5], arr)\n    arr[6] = _rewrite(_pairs[6], arr)\n    arr[7] = RegExp('\\\\\\\\(' + arr[3] + ')|([[({])|(' + arr[3] + ')|' + S_QBLOCKS, REGLOB)\n    arr[8] = pair\n    return arr\n  }\n\n  function _brackets (reOrIdx) {\n    return reOrIdx instanceof RegExp ? _regex(reOrIdx) : _cache[reOrIdx]\n  }\n\n  _brackets.split = function split (str, tmpl, _bp) {\n    // istanbul ignore next: _bp is for the compiler\n    if (!_bp) _bp = _cache\n\n    var\n      parts = [],\n      match,\n      isexpr,\n      start,\n      pos,\n      re = _bp[6]\n\n    isexpr = start = re.lastIndex = 0\n\n    while (match = re.exec(str)) {\n\n      pos = match.index\n\n      if (isexpr) {\n\n        if (match[2]) {\n          re.lastIndex = skipBraces(str, match[2], re.lastIndex)\n          continue\n        }\n        if (!match[3])\n          continue\n      }\n\n      if (!match[1]) {\n        unescapeStr(str.slice(start, pos))\n        start = re.lastIndex\n        re = _bp[6 + (isexpr ^= 1)]\n        re.lastIndex = start\n      }\n    }\n\n    if (str && start < str.length) {\n      unescapeStr(str.slice(start))\n    }\n\n    return parts\n\n    function unescapeStr (s) {\n      if (tmpl || isexpr)\n        parts.push(s && s.replace(_bp[5], '$1'))\n      else\n        parts.push(s)\n    }\n\n    function skipBraces (s, ch, ix) {\n      var\n        match,\n        recch = FINDBRACES[ch]\n\n      recch.lastIndex = ix\n      ix = 1\n      while (match = recch.exec(s)) {\n        if (match[1] &&\n          !(match[1] === ch ? ++ix : --ix)) break\n      }\n      return ix ? s.length : recch.lastIndex\n    }\n  }\n\n  _brackets.hasExpr = function hasExpr (str) {\n    return _cache[4].test(str)\n  }\n\n  _brackets.loopKeys = function loopKeys (expr) {\n    var m = expr.match(_cache[9])\n    return m\n      ? { key: m[1], pos: m[2], val: _cache[0] + m[3].trim() + _cache[1] }\n      : { val: expr.trim() }\n  }\n\n  _brackets.hasRaw = function (src) {\n    return _cache[10].test(src)\n  }\n\n  _brackets.array = function array (pair) {\n    return pair ? _create(pair) : _cache\n  }\n\n  function _reset (pair) {\n    if ((pair || (pair = DEFAULT)) !== _cache[8]) {\n      _cache = _create(pair)\n      _regex = pair === DEFAULT ? _loopback : _rewrite\n      _cache[9] = _regex(_pairs[9])\n      _cache[10] = _regex(_pairs[10])\n    }\n    cachedBrackets = pair\n  }\n\n  function _setSettings (o) {\n    var b\n    o = o || {}\n    b = o.brackets\n    Object.defineProperty(o, 'brackets', {\n      set: _reset,\n      get: function () { return cachedBrackets },\n      enumerable: true\n    })\n    _settings = o\n    _reset(b)\n  }\n\n  Object.defineProperty(_brackets, 'settings', {\n    set: _setSettings,\n    get: function () { return _settings }\n  })\n\n  /* istanbul ignore next: in the browser riot is always in the scope */\n  _brackets.settings = typeof riot !== 'undefined' && riot.settings || {}\n  _brackets.set = _reset\n\n  _brackets.R_STRINGS = R_STRINGS\n  _brackets.R_MLCOMMS = R_MLCOMMS\n  _brackets.S_QBLOCKS = S_QBLOCKS\n\n  return _brackets\n\n})()\n\n/**\n * @module tmpl\n *\n * tmpl          - Root function, returns the template value, render with data\n * tmpl.hasExpr  - Test the existence of a expression inside a string\n * tmpl.loopKeys - Get the keys for an 'each' loop (used by `_each`)\n */\n\nvar tmpl = (function () {\n\n  var _cache = {}\n\n  function _tmpl (str, data) {\n    if (!str) return str\n\n    return (_cache[str] || (_cache[str] = _create(str))).call(data, _logErr)\n  }\n\n  _tmpl.haveRaw = brackets.hasRaw\n\n  _tmpl.hasExpr = brackets.hasExpr\n\n  _tmpl.loopKeys = brackets.loopKeys\n\n  _tmpl.errorHandler = null\n\n  function _logErr (err, ctx) {\n\n    if (_tmpl.errorHandler) {\n\n      err.riotData = {\n        tagName: ctx && ctx.root && ctx.root.tagName,\n        _riot_id: ctx && ctx._riot_id  //eslint-disable-line camelcase\n      }\n      _tmpl.errorHandler(err)\n    }\n  }\n\n  function _create (str) {\n\n    var expr = _getTmpl(str)\n    if (expr.slice(0, 11) !== 'try{return ') expr = 'return ' + expr\n\n    return new Function('E', expr + ';')\n  }\n\n  var\n    RE_QBLOCK = RegExp(brackets.S_QBLOCKS, 'g'),\n    RE_QBMARK = /\\x01(\\d+)~/g\n\n  function _getTmpl (str) {\n    var\n      qstr = [],\n      expr,\n      parts = brackets.split(str.replace(/\\u2057/g, '\"'), 1)\n\n    if (parts.length > 2 || parts[0]) {\n      var i, j, list = []\n\n      for (i = j = 0; i < parts.length; ++i) {\n\n        expr = parts[i]\n\n        if (expr && (expr = i & 1 ?\n\n              _parseExpr(expr, 1, qstr) :\n\n              '\"' + expr\n                .replace(/\\\\/g, '\\\\\\\\')\n                .replace(/\\r\\n?|\\n/g, '\\\\n')\n                .replace(/\"/g, '\\\\\"') +\n              '\"'\n\n          )) list[j++] = expr\n\n      }\n\n      expr = j < 2 ? list[0] :\n             '[' + list.join(',') + '].join(\"\")'\n\n    } else {\n\n      expr = _parseExpr(parts[1], 0, qstr)\n    }\n\n    if (qstr[0])\n      expr = expr.replace(RE_QBMARK, function (_, pos) {\n        return qstr[pos]\n          .replace(/\\r/g, '\\\\r')\n          .replace(/\\n/g, '\\\\n')\n      })\n\n    return expr\n  }\n\n  var\n    RE_BREND = {\n      '(': /[()]/g,\n      '[': /[[\\]]/g,\n      '{': /[{}]/g\n    },\n    CS_IDENT = /^(?:(-?[_A-Za-z\\xA0-\\xFF][-\\w\\xA0-\\xFF]*)|\\x01(\\d+)~):/\n\n  function _parseExpr (expr, asText, qstr) {\n\n    if (expr[0] === '=') expr = expr.slice(1)\n\n    expr = expr\n          .replace(RE_QBLOCK, function (s, div) {\n            return s.length > 2 && !div ? '\\x01' + (qstr.push(s) - 1) + '~' : s\n          })\n          .replace(/\\s+/g, ' ').trim()\n          .replace(/\\ ?([[\\({},?\\.:])\\ ?/g, '$1')\n\n    if (expr) {\n      var\n        list = [],\n        cnt = 0,\n        match\n\n      while (expr &&\n            (match = expr.match(CS_IDENT)) &&\n            !match.index\n        ) {\n        var\n          key,\n          jsb,\n          re = /,|([[{(])|$/g\n\n        expr = RegExp.rightContext\n        key  = match[2] ? qstr[match[2]].slice(1, -1).trim().replace(/\\s+/g, ' ') : match[1]\n\n        while (jsb = (match = re.exec(expr))[1]) skipBraces(jsb, re)\n\n        jsb  = expr.slice(0, match.index)\n        expr = RegExp.rightContext\n\n        list[cnt++] = _wrapExpr(jsb, 1, key)\n      }\n\n      expr = !cnt ? _wrapExpr(expr, asText) :\n          cnt > 1 ? '[' + list.join(',') + '].join(\" \").trim()' : list[0]\n    }\n    return expr\n\n    function skipBraces (ch, re) {\n      var\n        mm,\n        lv = 1,\n        ir = RE_BREND[ch]\n\n      ir.lastIndex = re.lastIndex\n      while (mm = ir.exec(expr)) {\n        if (mm[0] === ch) ++lv\n        else if (!--lv) break\n      }\n      re.lastIndex = lv ? expr.length : ir.lastIndex\n    }\n  }\n\n  // istanbul ignore next: not both\n  var\n    JS_CONTEXT = '\"in this?this:' + (typeof window !== 'object' ? 'global' : 'window') + ').',\n    JS_VARNAME = /[,{][$\\w]+:|(^ *|[^$\\w\\.])(?!(?:typeof|true|false|null|undefined|in|instanceof|is(?:Finite|NaN)|void|NaN|new|Date|RegExp|Math)(?![$\\w]))([$_A-Za-z][$\\w]*)/g,\n    JS_NOPROPS = /^(?=(\\.[$\\w]+))\\1(?:[^.[(]|$)/\n\n  function _wrapExpr (expr, asText, key) {\n    var tb\n\n    expr = expr.replace(JS_VARNAME, function (match, p, mvar, pos, s) {\n      if (mvar) {\n        pos = tb ? 0 : pos + match.length\n\n        if (mvar !== 'this' && mvar !== 'global' && mvar !== 'window') {\n          match = p + '(\"' + mvar + JS_CONTEXT + mvar\n          if (pos) tb = (s = s[pos]) === '.' || s === '(' || s === '['\n        } else if (pos) {\n          tb = !JS_NOPROPS.test(s.slice(pos))\n        }\n      }\n      return match\n    })\n\n    if (tb) {\n      expr = 'try{return ' + expr + '}catch(e){E(e,this)}'\n    }\n\n    if (key) {\n\n      expr = (tb ?\n          'function(){' + expr + '}.call(this)' : '(' + expr + ')'\n        ) + '?\"' + key + '\":\"\"'\n\n    } else if (asText) {\n\n      expr = 'function(v){' + (tb ?\n          expr.replace('return ', 'v=') : 'v=(' + expr + ')'\n        ) + ';return v||v===0?v:\"\"}.call(this)'\n    }\n\n    return expr\n  }\n\n  // istanbul ignore next: compatibility fix for beta versions\n  _tmpl.parse = function (s) { return s }\n\n  _tmpl.version = brackets.version = 'v2.3.21'\n\n  return _tmpl\n\n})()\n\n/*\n  lib/browser/tag/mkdom.js\n\n  Includes hacks needed for the Internet Explorer version 9 and below\n  See: http://kangax.github.io/compat-table/es5/#ie8\n       http://codeplanet.io/dropping-ie8/\n*/\nvar mkdom = (function (checkIE) {\n  var\n    reHasYield  = /<yield\\b/i,\n    reYieldAll  = /<yield\\s*(?:\\/>|>([\\S\\s]*?)<\\/yield\\s*>)/ig,\n    reYieldCls  = /<yield\\s+to=[^>]+>[\\S\\s]*?<\\/yield\\s*>\\s*/ig,\n    reYieldDest = /<yield\\s+from=['\"]?([-\\w]+)['\"]?\\s*(?:\\/>|>([\\S\\s]*?)<\\/yield\\s*>)/ig,\n    rsYieldSrc  = '<yield\\\\s+to=[\\'\"]@[\\'\"]\\\\s*>([\\\\S\\\\s]*?)</yield\\\\s*>',\n    rootEls = { tr: 'tbody', th: 'tr', td: 'tr', col: 'colgroup' }\n\n  checkIE = checkIE && checkIE < 10\n  var tblTags = checkIE\n    ? SPECIAL_TAGS_REGEX : /^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?)$/\n\n  /**\n   * Creates a DOM element to wrap the given content. Normally an `DIV`, but can be\n   * also a `TABLE`, `SELECT`, `TBODY`, `TR`, or `COLGROUP` element.\n   *\n   * @param   {string} impl   - Tag implementation with the template and root attributes\n   * @param   {string} [html] - HTML content that comes from the DOM element where you\n   *           will mount the tag, mostly the original tag in the page\n   * @param   {object} [attr] - Plain object where to store the root attributes\n   * @returns {HTMLElement} DOM element with _templ_ merged through `YIELD` with the _html_.\n   */\n  function _mkdom(impl, html, attr) {\n\n    var templ = impl.tmpl,\n      match   = templ && templ.match(/^\\s*<([-\\w]+)/),\n      tagName = match && match[1].toLowerCase(),\n      el = mkEl('div')\n\n    if (!html) html = ''\n\n    if (impl.attrs) attr.attrs = replaceYield(impl.attrs, html)\n\n    // replace all the yield tags with the tag inner html\n    templ = replaceYield(templ, html)\n\n    /* istanbul ignore next */\n    if (tblTags.test(tagName))\n      el = specialTags(el, templ, tagName)\n    else\n      el.innerHTML = templ\n\n    el.stub = true\n\n    return el\n  }\n\n  /*\n    Creates the root element for table or select child elements:\n    tr/th/td/thead/tfoot/tbody/caption/col/colgroup/option/optgroup\n  */\n  function specialTags(el, templ, tagName) {\n    var\n      select = tagName[0] === 'o',\n      parent = select ? 'select>' : 'table>'\n\n    // trim() is important here, this ensures we don't have artifacts,\n    // so we can check if we have only one element inside the parent\n    el.innerHTML = '<' + parent + templ.trim() + '</' + parent\n    parent = el.firstChild\n\n    // returns the immediate parent if tr/th/td/col is the only element, if not\n    // returns the whole tree, as this can include additional elements\n    if (select) {\n      parent.selectedIndex = -1  // for IE9, compatible w/current riot behavior\n    } else {\n      var tname = rootEls[tagName]\n      if (tname && parent.childNodes.length === 1) parent = $(tname, parent)\n    }\n    return parent\n  }\n\n  /*\n    Replace the yield tag from any tag template with the innerHTML of the\n    original tag in the page\n  */\n  function replaceYield(templ, html) {\n    // do nothing if no yield\n    if (!reHasYield.test(templ)) return templ\n\n    // be careful with #1343 - string on the source having `$1`\n    var n = 1\n    templ = templ.replace(reYieldDest, function (_, ref, def) {\n      var m = html.match(RegExp(rsYieldSrc.replace('@', ref), 'i'))\n      n = 0\n      return (m ? m[1] : def) || ''\n    })\n\n    // yield without any \"from\", replace yield in templ with the innerHTML\n    if (n || reHasYield.test(templ)) {\n      if (html) html = html.replace(reYieldCls, '').trim()\n      templ = templ.replace(reYieldAll, function (_, def) {\n        return html || def || ''\n      })\n    }\n\n    return templ\n  }\n\n  return _mkdom\n\n})(IE_VERSION)\n\n/**\n * Convert the item looped into an object used to extend the child tag properties\n * @param   { Object } expr - object containing the keys used to extend the children tags\n * @param   { * } key - value to assign to the new object returned\n * @param   { * } val - value containing the position of the item in the array\n * @returns { Object } - new object containing the values of the original item\n *\n * The variables 'key' and 'val' are arbitrary.\n * They depend on the collection type looped (Array, Object)\n * and on the expression used on the each tag\n *\n */\nfunction mkitem(expr, key, val) {\n  var item = {}\n  item[expr.key] = key\n  if (expr.pos) item[expr.pos] = val\n  return item\n}\n\n/**\n * Unmount the redundant tags\n * @param   { Array } items - array containing the current items to loop\n * @param   { Array } tags - array containing all the children tags\n */\nfunction unmountRedundant(items, tags) {\n\n  var i = tags.length,\n    j = items.length,\n    t\n\n  while (i > j) {\n    t = tags[--i]\n    tags.splice(i, 1)\n    t.unmount()\n  }\n}\n\n/**\n * Move the nested custom tags in non custom loop tags\n * @param   { Object } child - non custom loop tag\n * @param   { Number } i - current position of the loop tag\n */\nfunction moveNestedTags(child, i) {\n  Object.keys(child.tags).forEach(function(tagName) {\n    var tag = child.tags[tagName]\n    if (isArray(tag))\n      each(tag, function (t) {\n        moveChildTag(t, tagName, i)\n      })\n    else\n      moveChildTag(tag, tagName, i)\n  })\n}\n\n/**\n * Adds the elements for a virtual tag\n * @param { Tag } tag - the tag whose root's children will be inserted or appended\n * @param { Node } src - the node that will do the inserting or appending\n * @param { Tag } target - only if inserting, insert before this tag's first child\n */\nfunction addVirtual(tag, src, target) {\n  var el = tag._root, sib\n  tag._virts = []\n  while (el) {\n    sib = el.nextSibling\n    if (target)\n      src.insertBefore(el, target._root)\n    else\n      src.appendChild(el)\n\n    tag._virts.push(el) // hold for unmounting\n    el = sib\n  }\n}\n\n/**\n * Move virtual tag and all child nodes\n * @param { Tag } tag - first child reference used to start move\n * @param { Node } src  - the node that will do the inserting\n * @param { Tag } target - insert before this tag's first child\n * @param { Number } len - how many child nodes to move\n */\nfunction moveVirtual(tag, src, target, len) {\n  var el = tag._root, sib, i = 0\n  for (; i < len; i++) {\n    sib = el.nextSibling\n    src.insertBefore(el, target._root)\n    el = sib\n  }\n}\n\n\n/**\n * Manage tags having the 'each'\n * @param   { Object } dom - DOM node we need to loop\n * @param   { Tag } parent - parent tag instance where the dom node is contained\n * @param   { String } expr - string contained in the 'each' attribute\n */\nfunction _each(dom, parent, expr) {\n\n  // remove the each property from the original tag\n  remAttr(dom, 'each')\n\n  var mustReorder = typeof getAttr(dom, 'no-reorder') !== T_STRING || remAttr(dom, 'no-reorder'),\n    tagName = getTagName(dom),\n    impl = __tagImpl[tagName] || { tmpl: dom.outerHTML },\n    useRoot = SPECIAL_TAGS_REGEX.test(tagName),\n    root = dom.parentNode,\n    ref = document.createTextNode(''),\n    child = getTag(dom),\n    isOption = /^option$/i.test(tagName), // the option tags must be treated differently\n    tags = [],\n    oldItems = [],\n    hasKeys,\n    isVirtual = dom.tagName == 'VIRTUAL'\n\n  // parse the each expression\n  expr = tmpl.loopKeys(expr)\n\n  // insert a marked where the loop tags will be injected\n  root.insertBefore(ref, dom)\n\n  // clean template code\n  parent.one('before-mount', function () {\n\n    // remove the original DOM node\n    dom.parentNode.removeChild(dom)\n    if (root.stub) root = parent.root\n\n  }).on('update', function () {\n    // get the new items collection\n    var items = tmpl(expr.val, parent),\n      // create a fragment to hold the new DOM nodes to inject in the parent tag\n      frag = document.createDocumentFragment()\n\n\n\n    // object loop. any changes cause full redraw\n    if (!isArray(items)) {\n      hasKeys = items || false\n      items = hasKeys ?\n        Object.keys(items).map(function (key) {\n          return mkitem(expr, key, items[key])\n        }) : []\n    }\n\n    // loop all the new items\n    var i = 0,\n      itemsLength = items.length\n\n    for (; i < itemsLength; i++) {\n      // reorder only if the items are objects\n      var\n        item = items[i],\n        _mustReorder = mustReorder && item instanceof Object && !hasKeys,\n        oldPos = oldItems.indexOf(item),\n        pos = ~oldPos && _mustReorder ? oldPos : i,\n        // does a tag exist in this position?\n        tag = tags[pos]\n\n      item = !hasKeys && expr.key ? mkitem(expr, item, i) : item\n\n      // new tag\n      if (\n        !_mustReorder && !tag // with no-reorder we just update the old tags\n        ||\n        _mustReorder && !~oldPos || !tag // by default we always try to reorder the DOM elements\n      ) {\n\n        tag = new Tag(impl, {\n          parent: parent,\n          isLoop: true,\n          hasImpl: !!__tagImpl[tagName],\n          root: useRoot ? root : dom.cloneNode(),\n          item: item\n        }, dom.innerHTML)\n\n        tag.mount()\n        if (isVirtual) tag._root = tag.root.firstChild // save reference for further moves or inserts\n        // this tag must be appended\n        if (i == tags.length || !tags[i]) { // fix 1581\n          if (isVirtual)\n            addVirtual(tag, frag)\n          else frag.appendChild(tag.root)\n        }\n        // this tag must be insert\n        else {\n          if (isVirtual)\n            addVirtual(tag, root, tags[i])\n          else root.insertBefore(tag.root, tags[i].root)\n          oldItems.splice(i, 0, item)\n        }\n\n        tags.splice(i, 0, tag)\n        pos = i // handled here so no move\n      } else tag.update(item)\n\n      // reorder the tag if it's not located in its previous position\n      if (\n        pos !== i && _mustReorder &&\n        tags[i] // fix 1581 unable to reproduce it in a test!\n      ) {\n        // update the DOM\n        if (isVirtual)\n          moveVirtual(tag, root, tags[i], dom.childNodes.length)\n        else root.insertBefore(tag.root, tags[i].root)\n        // update the position attribute if it exists\n        if (expr.pos)\n          tag[expr.pos] = i\n        // move the old tag instance\n        tags.splice(i, 0, tags.splice(pos, 1)[0])\n        // move the old item\n        oldItems.splice(i, 0, oldItems.splice(pos, 1)[0])\n        // if the loop tags are not custom\n        // we need to move all their custom tags into the right position\n        if (!child && tag.tags) moveNestedTags(tag, i)\n      }\n\n      // cache the original item to use it in the events bound to this node\n      // and its children\n      tag._item = item\n      // cache the real parent tag internally\n      defineProperty(tag, '_parent', parent)\n    }\n\n    // remove the redundant tags\n    unmountRedundant(items, tags)\n\n    // insert the new nodes\n    if (isOption) root.appendChild(frag)\n    else root.insertBefore(frag, ref)\n\n    // set the 'tags' property of the parent tag\n    // if child is 'undefined' it means that we don't need to set this property\n    // for example:\n    // we don't need store the `myTag.tags['div']` property if we are looping a div tag\n    // but we need to track the `myTag.tags['child']` property looping a custom child node named `child`\n    if (child) parent.tags[tagName] = tags\n\n    // clone the items array\n    oldItems = items.slice()\n\n  })\n\n}\n/**\n * Object that will be used to inject and manage the css of every tag instance\n */\nvar styleManager = (function(_riot) {\n\n  if (!window) return { // skip injection on the server\n    add: function () {},\n    inject: function () {}\n  }\n\n  var styleNode = (function () {\n    // create a new style element with the correct type\n    var newNode = mkEl('style')\n    setAttr(newNode, 'type', 'text/css')\n\n    // replace any user node or insert the new one into the head\n    var userNode = $('style[type=riot]')\n    if (userNode) {\n      if (userNode.id) newNode.id = userNode.id\n      userNode.parentNode.replaceChild(newNode, userNode)\n    }\n    else document.getElementsByTagName('head')[0].appendChild(newNode)\n\n    return newNode\n  })()\n\n  // Create cache and shortcut to the correct property\n  var cssTextProp = styleNode.styleSheet,\n    stylesToInject = ''\n\n  // Expose the style node in a non-modificable property\n  Object.defineProperty(_riot, 'styleNode', {\n    value: styleNode,\n    writable: true\n  })\n\n  /**\n   * Public api\n   */\n  return {\n    /**\n     * Save a tag style to be later injected into DOM\n     * @param   { String } css [description]\n     */\n    add: function(css) {\n      stylesToInject += css\n    },\n    /**\n     * Inject all previously saved tag styles into DOM\n     * innerHTML seems slow: http://jsperf.com/riot-insert-style\n     */\n    inject: function() {\n      if (stylesToInject) {\n        if (cssTextProp) cssTextProp.cssText += stylesToInject\n        else styleNode.innerHTML += stylesToInject\n        stylesToInject = ''\n      }\n    }\n  }\n\n})(riot)\n\n\nfunction parseNamedElements(root, tag, childTags, forceParsingNamed) {\n\n  walk(root, function(dom) {\n    if (dom.nodeType == 1) {\n      dom.isLoop = dom.isLoop ||\n                  (dom.parentNode && dom.parentNode.isLoop || getAttr(dom, 'each'))\n                    ? 1 : 0\n\n      // custom child tag\n      if (childTags) {\n        var child = getTag(dom)\n\n        if (child && !dom.isLoop)\n          childTags.push(initChildTag(child, {root: dom, parent: tag}, dom.innerHTML, tag))\n      }\n\n      if (!dom.isLoop || forceParsingNamed)\n        setNamed(dom, tag, [])\n    }\n\n  })\n\n}\n\nfunction parseExpressions(root, tag, expressions) {\n\n  function addExpr(dom, val, extra) {\n    if (tmpl.hasExpr(val)) {\n      expressions.push(extend({ dom: dom, expr: val }, extra))\n    }\n  }\n\n  walk(root, function(dom) {\n    var type = dom.nodeType,\n      attr\n\n    // text node\n    if (type == 3 && dom.parentNode.tagName != 'STYLE') addExpr(dom, dom.nodeValue)\n    if (type != 1) return\n\n    /* element */\n\n    // loop\n    attr = getAttr(dom, 'each')\n\n    if (attr) { _each(dom, tag, attr); return false }\n\n    // attribute expressions\n    each(dom.attributes, function(attr) {\n      var name = attr.name,\n        bool = name.split('__')[1]\n\n      addExpr(dom, attr.value, { attr: bool || name, bool: bool })\n      if (bool) { remAttr(dom, name); return false }\n\n    })\n\n    // skip custom tags\n    if (getTag(dom)) return false\n\n  })\n\n}\nfunction Tag(impl, conf, innerHTML) {\n\n  var self = riot.observable(this),\n    opts = inherit(conf.opts) || {},\n    parent = conf.parent,\n    isLoop = conf.isLoop,\n    hasImpl = conf.hasImpl,\n    item = cleanUpData(conf.item),\n    expressions = [],\n    childTags = [],\n    root = conf.root,\n    fn = impl.fn,\n    tagName = root.tagName.toLowerCase(),\n    attr = {},\n    implAttr = {},\n    propsInSyncWithParent = [],\n    dom\n\n  if (fn && root._tag) root._tag.unmount(true)\n\n  // not yet mounted\n  this.isMounted = false\n  root.isLoop = isLoop\n\n  // keep a reference to the tag just created\n  // so we will be able to mount this tag multiple times\n  root._tag = this\n\n  // create a unique id to this tag\n  // it could be handy to use it also to improve the virtual dom rendering speed\n  defineProperty(this, '_riot_id', ++__uid) // base 1 allows test !t._riot_id\n\n  extend(this, { parent: parent, root: root, opts: opts, tags: {} }, item)\n\n  // grab attributes\n  each(root.attributes, function(el) {\n    var val = el.value\n    // remember attributes with expressions only\n    if (tmpl.hasExpr(val)) attr[el.name] = val\n  })\n\n  dom = mkdom(impl, innerHTML, implAttr)\n  implAttr = implAttr.attrs || ''\n\n  // options\n  function updateOpts() {\n    var ctx = hasImpl && isLoop ? self : parent || self\n\n    // update opts from current DOM attributes\n    each(root.attributes, function(el) {\n      var val = el.value\n      opts[toCamel(el.name)] = tmpl.hasExpr(val) ? tmpl(val, ctx) : val\n    })\n    // recover those with expressions\n    each(Object.keys(attr), function(name) {\n      opts[toCamel(name)] = tmpl(attr[name], ctx)\n    })\n  }\n\n  function normalizeData(data) {\n    for (var key in item) {\n      if (typeof self[key] !== T_UNDEF && isWritable(self, key))\n        self[key] = data[key]\n    }\n  }\n\n  function inheritFromParent () {\n    if (!self.parent || !isLoop) return\n    each(Object.keys(self.parent), function(k) {\n      // some properties must be always in sync with the parent tag\n      var mustSync = !contains(RESERVED_WORDS_BLACKLIST, k) && contains(propsInSyncWithParent, k)\n      if (typeof self[k] === T_UNDEF || mustSync) {\n        // track the property to keep in sync\n        // so we can keep it updated\n        if (!mustSync) propsInSyncWithParent.push(k)\n        self[k] = self.parent[k]\n      }\n    })\n  }\n\n  defineProperty(this, 'update', function(data) {\n\n    // make sure the data passed will not override\n    // the component core methods\n    data = cleanUpData(data)\n    // inherit properties from the parent\n    inheritFromParent()\n    // normalize the tag properties in case an item object was initially passed\n    if (data && isObject(item)) {\n      normalizeData(data)\n      item = data\n    }\n    extend(self, data)\n    updateOpts()\n    self.trigger('update', data)\n    update(expressions, self)\n    // the updated event will be triggered\n    // once the DOM will be ready and all the reflows are completed\n    // this is useful if you want to get the \"real\" root properties\n    // 4 ex: root.offsetWidth ...\n    if (self.parent)\n      // closes #1599\n      self.parent.one('updated', function() { self.trigger('updated') })\n    else rAF(function() { self.trigger('updated') })\n\n    return this\n  })\n\n  defineProperty(this, 'mixin', function() {\n    each(arguments, function(mix) {\n      var instance\n\n      mix = typeof mix === T_STRING ? riot.mixin(mix) : mix\n\n      // check if the mixin is a function\n      if (isFunction(mix)) {\n        // create the new mixin instance\n        instance = new mix()\n        // save the prototype to loop it afterwards\n        mix = mix.prototype\n      } else instance = mix\n\n      // loop the keys in the function prototype or the all object keys\n      each(Object.getOwnPropertyNames(mix), function(key) {\n        // bind methods to self\n        if (key != 'init')\n          self[key] = isFunction(instance[key]) ?\n                        instance[key].bind(self) :\n                        instance[key]\n      })\n\n      // init method will be called automatically\n      if (instance.init) instance.init.bind(self)()\n    })\n    return this\n  })\n\n  defineProperty(this, 'mount', function() {\n\n    updateOpts()\n\n    // add global mixin\n    var globalMixin = riot.mixin(GLOBAL_MIXIN)\n    if (globalMixin) self.mixin(globalMixin)\n\n    // initialiation\n    if (fn) fn.call(self, opts)\n\n    // parse layout after init. fn may calculate args for nested custom tags\n    parseExpressions(dom, self, expressions)\n\n    // mount the child tags\n    toggle(true)\n\n    // update the root adding custom attributes coming from the compiler\n    // it fixes also #1087\n    if (implAttr || hasImpl) {\n      walkAttributes(implAttr, function (k, v) { setAttr(root, k, v) })\n      parseExpressions(self.root, self, expressions)\n    }\n\n    if (!self.parent || isLoop) self.update(item)\n\n    // internal use only, fixes #403\n    self.trigger('before-mount')\n\n    if (isLoop && !hasImpl) {\n      // update the root attribute for the looped elements\n      root = dom.firstChild\n    } else {\n      while (dom.firstChild) root.appendChild(dom.firstChild)\n      if (root.stub) root = parent.root\n    }\n\n    defineProperty(self, 'root', root)\n\n    // parse the named dom nodes in the looped child\n    // adding them to the parent as well\n    if (isLoop)\n      parseNamedElements(self.root, self.parent, null, true)\n\n    // if it's not a child tag we can trigger its mount event\n    if (!self.parent || self.parent.isMounted) {\n      self.isMounted = true\n      self.trigger('mount')\n    }\n    // otherwise we need to wait that the parent event gets triggered\n    else self.parent.one('mount', function() {\n      // avoid to trigger the `mount` event for the tags\n      // not visible included in an if statement\n      if (!isInStub(self.root)) {\n        self.parent.isMounted = self.isMounted = true\n        self.trigger('mount')\n      }\n    })\n  })\n\n\n  defineProperty(this, 'unmount', function(keepRootTag) {\n    var el = root,\n      p = el.parentNode,\n      ptag,\n      tagIndex = __virtualDom.indexOf(self)\n\n    self.trigger('before-unmount')\n\n    // remove this tag instance from the global virtualDom variable\n    if (~tagIndex)\n      __virtualDom.splice(tagIndex, 1)\n\n    if (this._virts) {\n      each(this._virts, function(v) {\n        if (v.parentNode) v.parentNode.removeChild(v)\n      })\n    }\n\n    if (p) {\n\n      if (parent) {\n        ptag = getImmediateCustomParentTag(parent)\n        // remove this tag from the parent tags object\n        // if there are multiple nested tags with same name..\n        // remove this element form the array\n        if (isArray(ptag.tags[tagName]))\n          each(ptag.tags[tagName], function(tag, i) {\n            if (tag._riot_id == self._riot_id)\n              ptag.tags[tagName].splice(i, 1)\n          })\n        else\n          // otherwise just delete the tag instance\n          ptag.tags[tagName] = undefined\n      }\n\n      else\n        while (el.firstChild) el.removeChild(el.firstChild)\n\n      if (!keepRootTag)\n        p.removeChild(el)\n      else\n        // the riot-tag attribute isn't needed anymore, remove it\n        remAttr(p, 'riot-tag')\n    }\n\n\n    self.trigger('unmount')\n    toggle()\n    self.off('*')\n    self.isMounted = false\n    delete root._tag\n\n  })\n\n  function toggle(isMount) {\n\n    // mount/unmount children\n    each(childTags, function(child) { child[isMount ? 'mount' : 'unmount']() })\n\n    // listen/unlisten parent (events flow one way from parent to children)\n    if (!parent) return\n    var evt = isMount ? 'on' : 'off'\n\n    // the loop tags will be always in sync with the parent automatically\n    if (isLoop)\n      parent[evt]('unmount', self.unmount)\n    else\n      parent[evt]('update', self.update)[evt]('unmount', self.unmount)\n  }\n\n  // named elements available for fn\n  parseNamedElements(dom, this, childTags)\n\n}\n/**\n * Attach an event to a DOM node\n * @param { String } name - event name\n * @param { Function } handler - event callback\n * @param { Object } dom - dom node\n * @param { Tag } tag - tag instance\n */\nfunction setEventHandler(name, handler, dom, tag) {\n\n  dom[name] = function(e) {\n\n    var ptag = tag._parent,\n      item = tag._item,\n      el\n\n    if (!item)\n      while (ptag && !item) {\n        item = ptag._item\n        ptag = ptag._parent\n      }\n\n    // cross browser event fix\n    e = e || window.event\n\n    // override the event properties\n    if (isWritable(e, 'currentTarget')) e.currentTarget = dom\n    if (isWritable(e, 'target')) e.target = e.srcElement\n    if (isWritable(e, 'which')) e.which = e.charCode || e.keyCode\n\n    e.item = item\n\n    // prevent default behaviour (by default)\n    if (handler.call(tag, e) !== true && !/radio|check/.test(dom.type)) {\n      if (e.preventDefault) e.preventDefault()\n      e.returnValue = false\n    }\n\n    if (!e.preventUpdate) {\n      el = item ? getImmediateCustomParentTag(ptag) : tag\n      el.update()\n    }\n\n  }\n\n}\n\n\n/**\n * Insert a DOM node replacing another one (used by if- attribute)\n * @param   { Object } root - parent node\n * @param   { Object } node - node replaced\n * @param   { Object } before - node added\n */\nfunction insertTo(root, node, before) {\n  if (!root) return\n  root.insertBefore(before, node)\n  root.removeChild(node)\n}\n\n/**\n * Update the expressions in a Tag instance\n * @param   { Array } expressions - expression that must be re evaluated\n * @param   { Tag } tag - tag instance\n */\nfunction update(expressions, tag) {\n\n  each(expressions, function(expr, i) {\n\n    var dom = expr.dom,\n      attrName = expr.attr,\n      value = tmpl(expr.expr, tag),\n      parent = expr.dom.parentNode\n\n    if (expr.bool)\n      value = !!value\n    else if (value == null)\n      value = ''\n\n    // textarea and text nodes has no attribute name\n    if (!attrName) {\n      // about #815 w/o replace: the browser converts the value to a string,\n      // the comparison by \"==\" does too, but not in the server\n      value += ''\n      // test for parent avoids error with invalid assignment to nodeValue\n      if (parent && dom.nodeValue != value) {\n        if (parent.tagName === 'TEXTAREA') {\n          parent.value = value                    // #1113\n          if (!IE_VERSION) dom.nodeValue = value  // #1625 IE throws here, nodeValue\n        }                                         // will be available on 'updated'\n        else dom.nodeValue = value\n      }\n      return\n    }\n\n    // #1612: look for changes in dom.value when updating the value\n    if (attrName === 'value') {\n      if (dom.value != value) dom.value = value\n      return\n    }\n\n    // was the expression value still the same?\n    if (expr.value === value) {\n      return\n    }\n    expr.value = value\n\n    // remove original attribute\n    remAttr(dom, attrName)\n\n    // event handler\n    if (isFunction(value)) {\n      setEventHandler(attrName, value, dom, tag)\n\n    // if- conditional\n    } else if (attrName == 'if') {\n      var stub = expr.stub,\n        add = function() { insertTo(stub.parentNode, stub, dom) },\n        remove = function() { insertTo(dom.parentNode, dom, stub) }\n\n      // add to DOM\n      if (value) {\n        if (stub) {\n          add()\n          dom.inStub = false\n          // avoid to trigger the mount event if the tags is not visible yet\n          // maybe we can optimize this avoiding to mount the tag at all\n          if (!isInStub(dom)) {\n            walk(dom, function(el) {\n              if (el._tag && !el._tag.isMounted)\n                el._tag.isMounted = !!el._tag.trigger('mount')\n            })\n          }\n        }\n      // remove from DOM\n      } else {\n        stub = expr.stub = stub || document.createTextNode('')\n        // if the parentNode is defined we can easily replace the tag\n        if (dom.parentNode)\n          remove()\n        // otherwise we need to wait the updated event\n        else (tag.parent || tag).one('updated', remove)\n\n        dom.inStub = true\n      }\n    // show / hide\n    } else if (attrName === 'show') {\n      dom.style.display = value ? '' : 'none'\n\n    } else if (attrName === 'hide') {\n      dom.style.display = value ? 'none' : ''\n\n    } else if (expr.bool) {\n      if (value) {\n        // #1374 <select> <option selected={true}> </select>\n        if (attrName === 'selected' && dom.nodeName === 'OPTION' && parent) {\n          parent.value = dom.value\n        }\n        setAttr(dom, attrName, attrName)\n      }\n\n    } else if (value === 0 || value && typeof value !== T_OBJECT) {\n      // <img src=\"{ expr }\">\n      if (startsWith(attrName, RIOT_PREFIX) && attrName != RIOT_TAG) {\n        attrName = attrName.slice(RIOT_PREFIX.length)\n      }\n      setAttr(dom, attrName, value)\n    }\n\n  })\n\n}\n/**\n * Specialized function for looping an array-like collection with `each={}`\n * @param   { Array } els - collection of items\n * @param   {Function} fn - callback function\n * @returns { Array } the array looped\n */\nfunction each(els, fn) {\n  var len = els ? els.length : 0\n\n  for (var i = 0, el; i < len; i++) {\n    el = els[i]\n    // return false -> current item was removed by fn during the loop\n    if (el != null && fn(el, i) === false) i--\n  }\n  return els\n}\n\n/**\n * Detect if the argument passed is a function\n * @param   { * } v - whatever you want to pass to this function\n * @returns { Boolean } -\n */\nfunction isFunction(v) {\n  return typeof v === T_FUNCTION || false   // avoid IE problems\n}\n\n/**\n * Detect if the argument passed is an object, exclude null.\n * NOTE: Use isObject(x) && !isArray(x) to excludes arrays.\n * @param   { * } v - whatever you want to pass to this function\n * @returns { Boolean } -\n */\nfunction isObject(v) {\n  return v && typeof v === T_OBJECT         // typeof null is 'object'\n}\n\n/**\n * Remove any DOM attribute from a node\n * @param   { Object } dom - DOM node we want to update\n * @param   { String } name - name of the property we want to remove\n */\nfunction remAttr(dom, name) {\n  dom.removeAttribute(name)\n}\n\n/**\n * Convert a string containing dashes to camel case\n * @param   { String } string - input string\n * @returns { String } my-string -> myString\n */\nfunction toCamel(string) {\n  return string.replace(/-(\\w)/g, function(_, c) {\n    return c.toUpperCase()\n  })\n}\n\n/**\n * Get the value of any DOM attribute on a node\n * @param   { Object } dom - DOM node we want to parse\n * @param   { String } name - name of the attribute we want to get\n * @returns { String | undefined } name of the node attribute whether it exists\n */\nfunction getAttr(dom, name) {\n  return dom.getAttribute(name)\n}\n\n/**\n * Set any DOM attribute\n * @param { Object } dom - DOM node we want to update\n * @param { String } name - name of the property we want to set\n * @param { String } val - value of the property we want to set\n */\nfunction setAttr(dom, name, val) {\n  dom.setAttribute(name, val)\n}\n\n/**\n * Detect the tag implementation by a DOM node\n * @param   { Object } dom - DOM node we need to parse to get its tag implementation\n * @returns { Object } it returns an object containing the implementation of a custom tag (template and boot function)\n */\nfunction getTag(dom) {\n  return dom.tagName && __tagImpl[getAttr(dom, RIOT_TAG) || dom.tagName.toLowerCase()]\n}\n/**\n * Add a child tag to its parent into the `tags` object\n * @param   { Object } tag - child tag instance\n * @param   { String } tagName - key where the new tag will be stored\n * @param   { Object } parent - tag instance where the new child tag will be included\n */\nfunction addChildTag(tag, tagName, parent) {\n  var cachedTag = parent.tags[tagName]\n\n  // if there are multiple children tags having the same name\n  if (cachedTag) {\n    // if the parent tags property is not yet an array\n    // create it adding the first cached tag\n    if (!isArray(cachedTag))\n      // don't add the same tag twice\n      if (cachedTag !== tag)\n        parent.tags[tagName] = [cachedTag]\n    // add the new nested tag to the array\n    if (!contains(parent.tags[tagName], tag))\n      parent.tags[tagName].push(tag)\n  } else {\n    parent.tags[tagName] = tag\n  }\n}\n\n/**\n * Move the position of a custom tag in its parent tag\n * @param   { Object } tag - child tag instance\n * @param   { String } tagName - key where the tag was stored\n * @param   { Number } newPos - index where the new tag will be stored\n */\nfunction moveChildTag(tag, tagName, newPos) {\n  var parent = tag.parent,\n    tags\n  // no parent no move\n  if (!parent) return\n\n  tags = parent.tags[tagName]\n\n  if (isArray(tags))\n    tags.splice(newPos, 0, tags.splice(tags.indexOf(tag), 1)[0])\n  else addChildTag(tag, tagName, parent)\n}\n\n/**\n * Create a new child tag including it correctly into its parent\n * @param   { Object } child - child tag implementation\n * @param   { Object } opts - tag options containing the DOM node where the tag will be mounted\n * @param   { String } innerHTML - inner html of the child node\n * @param   { Object } parent - instance of the parent tag including the child custom tag\n * @returns { Object } instance of the new child tag just created\n */\nfunction initChildTag(child, opts, innerHTML, parent) {\n  var tag = new Tag(child, opts, innerHTML),\n    tagName = getTagName(opts.root),\n    ptag = getImmediateCustomParentTag(parent)\n  // fix for the parent attribute in the looped elements\n  tag.parent = ptag\n  // store the real parent tag\n  // in some cases this could be different from the custom parent tag\n  // for example in nested loops\n  tag._parent = parent\n\n  // add this tag to the custom parent tag\n  addChildTag(tag, tagName, ptag)\n  // and also to the real parent tag\n  if (ptag !== parent)\n    addChildTag(tag, tagName, parent)\n  // empty the child node once we got its template\n  // to avoid that its children get compiled multiple times\n  opts.root.innerHTML = ''\n\n  return tag\n}\n\n/**\n * Loop backward all the parents tree to detect the first custom parent tag\n * @param   { Object } tag - a Tag instance\n * @returns { Object } the instance of the first custom parent tag found\n */\nfunction getImmediateCustomParentTag(tag) {\n  var ptag = tag\n  while (!getTag(ptag.root)) {\n    if (!ptag.parent) break\n    ptag = ptag.parent\n  }\n  return ptag\n}\n\n/**\n * Helper function to set an immutable property\n * @param   { Object } el - object where the new property will be set\n * @param   { String } key - object key where the new property will be stored\n * @param   { * } value - value of the new property\n* @param   { Object } options - set the propery overriding the default options\n * @returns { Object } - the initial object\n */\nfunction defineProperty(el, key, value, options) {\n  Object.defineProperty(el, key, extend({\n    value: value,\n    enumerable: false,\n    writable: false,\n    configurable: false\n  }, options))\n  return el\n}\n\n/**\n * Get the tag name of any DOM node\n * @param   { Object } dom - DOM node we want to parse\n * @returns { String } name to identify this dom node in riot\n */\nfunction getTagName(dom) {\n  var child = getTag(dom),\n    namedTag = getAttr(dom, 'name'),\n    tagName = namedTag && !tmpl.hasExpr(namedTag) ?\n                namedTag :\n              child ? child.name : dom.tagName.toLowerCase()\n\n  return tagName\n}\n\n/**\n * Extend any object with other properties\n * @param   { Object } src - source object\n * @returns { Object } the resulting extended object\n *\n * var obj = { foo: 'baz' }\n * extend(obj, {bar: 'bar', foo: 'bar'})\n * console.log(obj) => {bar: 'bar', foo: 'bar'}\n *\n */\nfunction extend(src) {\n  var obj, args = arguments\n  for (var i = 1; i < args.length; ++i) {\n    if (obj = args[i]) {\n      for (var key in obj) {\n        // check if this property of the source object could be overridden\n        if (isWritable(src, key))\n          src[key] = obj[key]\n      }\n    }\n  }\n  return src\n}\n\n/**\n * Check whether an array contains an item\n * @param   { Array } arr - target array\n * @param   { * } item - item to test\n * @returns { Boolean } Does 'arr' contain 'item'?\n */\nfunction contains(arr, item) {\n  return ~arr.indexOf(item)\n}\n\n/**\n * Check whether an object is a kind of array\n * @param   { * } a - anything\n * @returns {Boolean} is 'a' an array?\n */\nfunction isArray(a) { return Array.isArray(a) || a instanceof Array }\n\n/**\n * Detect whether a property of an object could be overridden\n * @param   { Object }  obj - source object\n * @param   { String }  key - object property\n * @returns { Boolean } is this property writable?\n */\nfunction isWritable(obj, key) {\n  var props = Object.getOwnPropertyDescriptor(obj, key)\n  return typeof obj[key] === T_UNDEF || props && props.writable\n}\n\n\n/**\n * With this function we avoid that the internal Tag methods get overridden\n * @param   { Object } data - options we want to use to extend the tag instance\n * @returns { Object } clean object without containing the riot internal reserved words\n */\nfunction cleanUpData(data) {\n  if (!(data instanceof Tag) && !(data && typeof data.trigger == T_FUNCTION))\n    return data\n\n  var o = {}\n  for (var key in data) {\n    if (!contains(RESERVED_WORDS_BLACKLIST, key))\n      o[key] = data[key]\n  }\n  return o\n}\n\n/**\n * Walk down recursively all the children tags starting dom node\n * @param   { Object }   dom - starting node where we will start the recursion\n * @param   { Function } fn - callback to transform the child node just found\n */\nfunction walk(dom, fn) {\n  if (dom) {\n    // stop the recursion\n    if (fn(dom) === false) return\n    else {\n      dom = dom.firstChild\n\n      while (dom) {\n        walk(dom, fn)\n        dom = dom.nextSibling\n      }\n    }\n  }\n}\n\n/**\n * Minimize risk: only zero or one _space_ between attr & value\n * @param   { String }   html - html string we want to parse\n * @param   { Function } fn - callback function to apply on any attribute found\n */\nfunction walkAttributes(html, fn) {\n  var m,\n    re = /([-\\w]+) ?= ?(?:\"([^\"]*)|'([^']*)|({[^}]*}))/g\n\n  while (m = re.exec(html)) {\n    fn(m[1].toLowerCase(), m[2] || m[3] || m[4])\n  }\n}\n\n/**\n * Check whether a DOM node is in stub mode, useful for the riot 'if' directive\n * @param   { Object }  dom - DOM node we want to parse\n * @returns { Boolean } -\n */\nfunction isInStub(dom) {\n  while (dom) {\n    if (dom.inStub) return true\n    dom = dom.parentNode\n  }\n  return false\n}\n\n/**\n * Create a generic DOM node\n * @param   { String } name - name of the DOM node we want to create\n * @returns { Object } DOM node just created\n */\nfunction mkEl(name) {\n  return document.createElement(name)\n}\n\n/**\n * Shorter and fast way to select multiple nodes in the DOM\n * @param   { String } selector - DOM selector\n * @param   { Object } ctx - DOM node where the targets of our search will is located\n * @returns { Object } dom nodes found\n */\nfunction $$(selector, ctx) {\n  return (ctx || document).querySelectorAll(selector)\n}\n\n/**\n * Shorter and fast way to select a single node in the DOM\n * @param   { String } selector - unique dom selector\n * @param   { Object } ctx - DOM node where the target of our search will is located\n * @returns { Object } dom node found\n */\nfunction $(selector, ctx) {\n  return (ctx || document).querySelector(selector)\n}\n\n/**\n * Simple object prototypal inheritance\n * @param   { Object } parent - parent object\n * @returns { Object } child instance\n */\nfunction inherit(parent) {\n  function Child() {}\n  Child.prototype = parent\n  return new Child()\n}\n\n/**\n * Get the name property needed to identify a DOM node in riot\n * @param   { Object } dom - DOM node we need to parse\n * @returns { String | undefined } give us back a string to identify this dom node\n */\nfunction getNamedKey(dom) {\n  return getAttr(dom, 'id') || getAttr(dom, 'name')\n}\n\n/**\n * Set the named properties of a tag element\n * @param { Object } dom - DOM node we need to parse\n * @param { Object } parent - tag instance where the named dom element will be eventually added\n * @param { Array } keys - list of all the tag instance properties\n */\nfunction setNamed(dom, parent, keys) {\n  // get the key value we want to add to the tag instance\n  var key = getNamedKey(dom),\n    isArr,\n    // add the node detected to a tag instance using the named property\n    add = function(value) {\n      // avoid to override the tag properties already set\n      if (contains(keys, key)) return\n      // check whether this value is an array\n      isArr = isArray(value)\n      // if the key was never set\n      if (!value)\n        // set it once on the tag instance\n        parent[key] = dom\n      // if it was an array and not yet set\n      else if (!isArr || isArr && !contains(value, dom)) {\n        // add the dom node into the array\n        if (isArr)\n          value.push(dom)\n        else\n          parent[key] = [value, dom]\n      }\n    }\n\n  // skip the elements with no named properties\n  if (!key) return\n\n  // check whether this key has been already evaluated\n  if (tmpl.hasExpr(key))\n    // wait the first updated event only once\n    parent.one('mount', function() {\n      key = getNamedKey(dom)\n      add(parent[key])\n    })\n  else\n    add(parent[key])\n\n}\n\n/**\n * Faster String startsWith alternative\n * @param   { String } src - source string\n * @param   { String } str - test string\n * @returns { Boolean } -\n */\nfunction startsWith(src, str) {\n  return src.slice(0, str.length) === str\n}\n\n/**\n * requestAnimationFrame function\n * Adapted from https://gist.github.com/paulirish/1579671, license MIT\n */\nvar rAF = (function (w) {\n  var raf = w.requestAnimationFrame    ||\n            w.mozRequestAnimationFrame || w.webkitRequestAnimationFrame\n\n  if (!raf || /iP(ad|hone|od).*OS 6/.test(w.navigator.userAgent)) {  // buggy iOS6\n    var lastTime = 0\n\n    raf = function (cb) {\n      var nowtime = Date.now(), timeout = Math.max(16 - (nowtime - lastTime), 0)\n      setTimeout(function () { cb(lastTime = nowtime + timeout) }, timeout)\n    }\n  }\n  return raf\n\n})(window || {})\n\n/**\n * Mount a tag creating new Tag instance\n * @param   { Object } root - dom node where the tag will be mounted\n * @param   { String } tagName - name of the riot tag we want to mount\n * @param   { Object } opts - options to pass to the Tag instance\n * @returns { Tag } a new Tag instance\n */\nfunction mountTo(root, tagName, opts) {\n  var tag = __tagImpl[tagName],\n    // cache the inner HTML to fix #855\n    innerHTML = root._innerHTML = root._innerHTML || root.innerHTML\n\n  // clear the inner html\n  root.innerHTML = ''\n\n  if (tag && root) tag = new Tag(tag, { root: root, opts: opts }, innerHTML)\n\n  if (tag && tag.mount) {\n    tag.mount()\n    // add this tag to the virtualDom variable\n    if (!contains(__virtualDom, tag)) __virtualDom.push(tag)\n  }\n\n  return tag\n}\n/**\n * Riot public api\n */\n\n// share methods for other riot parts, e.g. compiler\nriot.util = { brackets: brackets, tmpl: tmpl }\n\n/**\n * Create a mixin that could be globally shared across all the tags\n */\nriot.mixin = (function() {\n  var mixins = {}\n\n  /**\n   * Create/Return a mixin by its name\n   * @param   { String } name - mixin name (global mixin if missing)\n   * @param   { Object } mixin - mixin logic\n   * @returns { Object } the mixin logic\n   */\n  return function(name, mixin) {\n    if (isObject(name)) {\n      mixin = name\n      mixins[GLOBAL_MIXIN] = extend(mixins[GLOBAL_MIXIN] || {}, mixin)\n      return\n    }\n\n    if (!mixin) return mixins[name]\n    mixins[name] = mixin\n  }\n\n})()\n\n/**\n * Create a new riot tag implementation\n * @param   { String }   name - name/id of the new riot tag\n * @param   { String }   html - tag template\n * @param   { String }   css - custom tag css\n * @param   { String }   attrs - root tag attributes\n * @param   { Function } fn - user function\n * @returns { String } name/id of the tag just created\n */\nriot.tag = function(name, html, css, attrs, fn) {\n  if (isFunction(attrs)) {\n    fn = attrs\n    if (/^[\\w\\-]+\\s?=/.test(css)) {\n      attrs = css\n      css = ''\n    } else attrs = ''\n  }\n  if (css) {\n    if (isFunction(css)) fn = css\n    else styleManager.add(css)\n  }\n  __tagImpl[name] = { name: name, tmpl: html, attrs: attrs, fn: fn }\n  return name\n}\n\n/**\n * Create a new riot tag implementation (for use by the compiler)\n * @param   { String }   name - name/id of the new riot tag\n * @param   { String }   html - tag template\n * @param   { String }   css - custom tag css\n * @param   { String }   attrs - root tag attributes\n * @param   { Function } fn - user function\n * @param   { string }  [bpair] - brackets used in the compilation\n * @returns { String } name/id of the tag just created\n */\nriot.tag2 = function(name, html, css, attrs, fn, bpair) {\n  if (css) styleManager.add(css)\n  //if (bpair) riot.settings.brackets = bpair\n  __tagImpl[name] = { name: name, tmpl: html, attrs: attrs, fn: fn }\n  return name\n}\n\n/**\n * Mount a tag using a specific tag implementation\n * @param   { String } selector - tag DOM selector\n * @param   { String } tagName - tag implementation name\n * @param   { Object } opts - tag logic\n * @returns { Array } new tags instances\n */\nriot.mount = function(selector, tagName, opts) {\n\n  var els,\n    allTags,\n    tags = []\n\n  // helper functions\n\n  function addRiotTags(arr) {\n    var list = ''\n    each(arr, function (e) {\n      if (!/[^-\\w]/.test(e))\n        list += ',*[' + RIOT_TAG + '=' + e.trim() + ']'\n    })\n    return list\n  }\n\n  function selectAllTags() {\n    var keys = Object.keys(__tagImpl)\n    return keys + addRiotTags(keys)\n  }\n\n  function pushTags(root) {\n    if (root.tagName) {\n      var riotTag = getAttr(root, RIOT_TAG)\n\n      // have tagName? force riot-tag to be the same\n      if (tagName && riotTag !== tagName) {\n        riotTag = tagName\n        setAttr(root, RIOT_TAG, tagName)\n      }\n      var tag = mountTo(root, riotTag || root.tagName.toLowerCase(), opts)\n\n      if (tag) tags.push(tag)\n    } else if (root.length) {\n      each(root, pushTags)   // assume nodeList\n    }\n  }\n\n  // ----- mount code -----\n\n  // inject styles into DOM\n  styleManager.inject()\n\n  if (isObject(tagName)) {\n    opts = tagName\n    tagName = 0\n  }\n\n  // crawl the DOM to find the tag\n  if (typeof selector === T_STRING) {\n    if (selector === '*')\n      // select all the tags registered\n      // and also the tags found with the riot-tag attribute set\n      selector = allTags = selectAllTags()\n    else\n      // or just the ones named like the selector\n      selector += addRiotTags(selector.split(/, ?/))\n\n    // make sure to pass always a selector\n    // to the querySelectorAll function\n    els = selector ? $$(selector) : []\n  }\n  else\n    // probably you have passed already a tag or a NodeList\n    els = selector\n\n  // select all the registered and mount them inside their root elements\n  if (tagName === '*') {\n    // get all custom tags\n    tagName = allTags || selectAllTags()\n    // if the root els it's just a single tag\n    if (els.tagName)\n      els = $$(tagName, els)\n    else {\n      // select all the children for all the different root elements\n      var nodeList = []\n      each(els, function (_el) {\n        nodeList.push($$(tagName, _el))\n      })\n      els = nodeList\n    }\n    // get rid of the tagName\n    tagName = 0\n  }\n\n  pushTags(els)\n\n  return tags\n}\n\n/**\n * Update all the tags instances created\n * @returns { Array } all the tags instances\n */\nriot.update = function() {\n  return each(__virtualDom, function(tag) {\n    tag.update()\n  })\n}\n\n/**\n * Export the Tag constructor\n */\nriot.Tag = Tag\n  // support CommonJS, AMD & browser\n  /* istanbul ignore next */\n  if (typeof exports === T_OBJECT)\n    module.exports = riot\n  else if (typeof define === T_FUNCTION && typeof define.amd !== T_UNDEF)\n    define(function() { return riot })\n  else\n    window.riot = riot\n\n})(typeof window != 'undefined' ? window : void 0);\n","var riot = require('riot');\nmodule.exports = riot.tag2('user-view', '<div class=\"view user-view\" show=\"{user}\"> <ul> <li><span class=\"label\">user:</span> {user.id}</li> <li><span class=\"label\">created:</span> {filters.fromNow(user.created)} ago</li> <li><span class=\"label\">karma:</span> {user.karma}</li> <li> <span class=\"label\">about:</span> <div class=\"about\" name=\"about\"></div> </li> </ul> <p class=\"links\"> <a href=\"https://news.ycombinator.com/submitted?id={user.id}\">submissions</a><br> <a href=\"https://news.ycombinator.com/threads?id={user.id}\">comments</a> </p> </div>', '', '', function(opts) {\n  var store = require('../store')\n  var self = this\n  self.on('mount', function() {\n    store.fetchUser(opts.data, function (user) {\n      self.user = user\n      self.about.innerHTML = self.user.about\n      self.update()\n    })\n  })\n}, '{ }');\n","var riot = require('riot');\nmodule.exports = riot.tag2('item-view', '<div class=\"view item-view\" show=\"{items.length}\"> <item class=\"item\" each=\"{items}\" data=\"{this}\"></item> <ul class=\"poll-options\" if=\"{pollOptions}\"> <li each=\"{pollOptions}\"> <p>{text}</p> <p class=\"subtext\">{score} points</p> </li> </ul> <ul class=\"comments\"> <div each=\"{c, i in comments}\"> <comment data=\"{c}\"></comment> </div> </ul> <p show=\"{!comments.length}\">No comments yet.</p> </div>', '', '', function(opts) {\n  require('../components/item.html')\n  require('../components/comment.html')\n  var store = require('../store')\n  var self = this\n  self.items = []\n\n  this.fetchComments = function() {\n    store.fetchItems(self.items[0].kids, function (comments) {\n      self.comments = comments\n      self.update()\n    })\n  }.bind(this)\n\n  this.fetchPollOptions = function() {\n    store.fetchItems(self.items[0].parts, function (options) {\n      self.pollOptions = options\n      self.update()\n    })\n  }.bind(this)\n\n  store.fetchItem(opts.data, function (item) {\n    self.items = [ item ]\n    self.fetchComments()\n    if (item.type === 'poll') {\n      self.fetchPollOptions()\n    }\n    self.update()\n  })\n}, '{ }');\n","var riot = require('riot');\nmodule.exports = riot.tag2('news-view', '<div class=\"view news-view\" class=\"{loading: !items.length}\"> <ul> <li class=\"item\" each=\"{item, i in items}\" track-by=\"id\"> <item data=\"{item}\" index=\"{(parent.page - 1) * 30 + i + 1}\"></item> </li> </ul> <div class=\"nav\" show=\"{items.length}\"> <a if=\"{page > 1}\" href=\"#news/{page - 1}\">&lt; prev</a> <a if=\"{page < 4}\" href=\"#news/{page - -1}\">more...</a> </div> </div>', '', '', function(opts) {\n  require('../components/item.html')\n  var store = require('../store')\n  var self = this\n  self.page = opts.data\n  self.items = []\n\n  this.fetchNews = function() {\n    store.fetchItemsByPage(self.page, function (items) {\n      self.items = items\n      self.displayPage = self.page\n      self.update()\n    })\n  }.bind(this)\n\n  self.on('mount', function() {\n    self.fetchNews()\n    store.on('update', self.fetchNews)\n  })\n\n  self.on('unmount', function() {\n    store.removeListener('update', self.fetchNews)\n  })\n}, '{ }');\n","var api = new Firebase('https://hacker-news.firebaseio.com/v0')\nvar storiesPerPage = 30\nvar cachedStoryIds = []\nvar Emitter = require('events').EventEmitter\nvar store = new Emitter()\n\n/**\n * Subscribe to real time updates of the top 100 stories,\n * and cache the IDs locally.\n */\n\napi.child('topstories').on('value', function (snapshot) {\n  cachedStoryIds = snapshot.val()\n  store.emit('update')\n})\n\n/**\n * Fetch an item data with given id.\n *\n * @param {Number} id\n * @param {Function} cb(item)\n */\n\nstore.fetchItem = function (id, cb) {\n  api.child('item/' + id).once('value', function (snapshot) {\n    cb(snapshot.val())\n  })\n}\n\n/**\n * Fetch a user data with given id.\n *\n * @param {Number} id\n * @param {Function} cb(user)\n */\n\nstore.fetchUser = function (id, cb) {\n  api.child('user/' + id).once('value', function (snapshot) {\n    cb(snapshot.val())\n  })\n}\n\n/**\n * Fetch the given list of items.\n *\n * @param {Array<Number>} ids\n * @param {Function} cb(items)\n */\n\nstore.fetchItems = function (ids, cb) {\n  if (!ids || !ids.length) return cb([])\n  var items = []\n  ids.forEach(function (id) {\n    store.fetchItem(id, addItem)\n  })\n  function addItem (item) {\n    items.push(item)\n    if (items.length >= ids.length) {\n      cb(items)\n    }\n  }\n}\n\n/**\n * Fetch items for the given page.\n *\n * @param {Number} page\n * @param {Function} cb(stories)\n */\n\nstore.fetchItemsByPage = function (page, cb) {\n  var start = (page - 1) * storiesPerPage\n  var end = page * storiesPerPage\n  var ids = cachedStoryIds.slice(start, end)\n  store.fetchItems(ids, cb)\n}\n\nmodule.exports = store\n","var riot = require('riot');\nmodule.exports = riot.tag2('item', '<span class=\"index\">{opts.index}.</span> <p> <a class=\"title\" href=\"{href()}\" target=\"_blank\">{itemdata.title}</a> <span class=\"domain\" show=\"{showDomain()}\"> ({filters.domain(itemdata.url)}) </span> </p> <p class=\"subtext\"> <span show=\"{showInfo()}\"> {itemdata.score} points by <a href=\"#user/{itemdata.by}\">{itemdata.by}</a> </span> {filters.fromNow(itemdata.time)} ago <span class=\"comments-link\" show=\"{showInfo()}\"> | <a href=\"#item/{itemdata.id}\">{itemdata.descendants} comments</a> </span> </p>', '', '', function(opts) {\n  var self = this\n  self.itemdata = opts.data\n\n  this.href = function() {\n    return self.itemdata.url || ('#/item/' + self.itemdata.id)\n  }.bind(this)\n\n  this.showInfo = function() {\n    return self.itemdata.type === 'story' || self.itemdata.type === 'poll'\n  }.bind(this)\n\n  this.showDomain = function() {\n    return self.itemdata.type === 'story'\n  }.bind(this)\n}, '{ }');\n","var riot = require('riot');\nmodule.exports = riot.tag2('comment', '<li show=\"{data.text}\"> <div class=\"comhead\"> <a class=\"toggle\" onclick=\"{toggle}\">{open ? \\'[-]\\' : \\'[+]\\'}</a> <a href=\"#user/{data.by}\">{data.by}</a> {filters.fromNow(data.time)} ago </div> <div class=\"comment-content\" name=\"commentcontent\" show=\"{open}\"></div> <ul class=\"child-comments\" if=\"{data.kids}\" show=\"{open}\"> <div each=\"{c, i in comments}\"> <comment data=\"{c}\"></comment> <div> </ul> </li>', '', '', function(opts) {\n  var store = require('../store')\n  var self = this\n  self.data = opts.data\n  self.open = true\n  self.commentcontent.innerHTML = self.data.text\n\n  store.fetchItems(self.data.kids, function(result) {\n    self.comments = result\n    self.update()\n  })\n\n  this.toggle = function(e) {\n    this.open = !this.open\n  }.bind(this)\n}, '{ }');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n"]}